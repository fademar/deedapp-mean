<simple-notifications [options]="options"></simple-notifications>
<form (keydown.enter)="$event.preventDefault()" [formGroup]="deedForm" (ngSubmit)="onSubmit(submitBtn)" novalidate>

  <mat-toolbar color="primary" class="nav-bar" id="cssmenu">

    <span class="nav-brand mr-5">Deed App</span>
    <ul>
      <li routerLinkActive="active">
        <a [routerLink]="['/list']">List</a>
      </li>
      <li routerLinkActive="active">
        <a [routerLink]="['/deed/add']">New Deed</a>
      </li>
      <li routerLinkActive="active">
        <a [routerLink]="['/search']" appNewWindow>Search</a>
      </li>
      <li routerLinkActive="active">
        <a [routerLink]="['/notes']" target="_blank">Notes</a>
      </li>
      <li routerLinkActive="active">
        <a [routerLink]="['/tools']">Tools</a>
      </li>
    </ul>
    <span class="spacer"></span>
    <button mat-raised-button type="submit" #submitBtn [disabled]="disableSubmit" placement="bottom" matTooltip="Save the deed" class="submit-button"
      matTooltipPosition="before" matTooltipClass="'tooltip'">
      <mat-icon aria-label="Submit the form">save</mat-icon> SAVE
    </button>
    <button mat-icon-button class="logout-button" (click)="auth.logout()">
      <mat-icon class="nav-icon md-24" aria-label="Logout">power_settings_new</mat-icon>
    </button>
  </mat-toolbar>
  <div class="actionsroot">
    <div class="actionspanel">
      <mat-card>
        <mat-card-title>ADD</mat-card-title>
        <mat-card-content>
          <div class="d-flex flex-column">
            <button mat-raised-button class="text-left" type="button" (click)="addCoAgent()">Co-Agent</button>
            <button mat-raised-button class="text-left" *ngIf="!collectiveCoAgentOn" (click)="addCollectiveCoAgent()" type="button">Collective Co-Agent</button>
            <button mat-raised-button class="text-left" type="button" (click)="addCoCounterAgent()">Co-Counter Agent</button>
            <button mat-raised-button class="mb-2 text-left" *ngIf="!collectiveCoCounterAgentOn" type="button" (click)="addCollectiveCoCounterAgent()">Collective Co-Counter Agent</button>
            <button mat-raised-button class="mb-2 text-left" type="button" (click)="addTransaction()">Transaction</button>
            <button mat-raised-button class="text-left" type="button" (click)="addWhitness()">Whitness</button>
            <button mat-raised-button class="text-left" type="button" (click)="addSurety()">Surety</button>
            <button mat-raised-button class="text-left" *ngIf="!scribeOn" type="button" (click)="addScribe()">Scribe</button>
            <button mat-raised-button class="text-left" type="button" (click)="addOtherParticipant()">Other Participant</button>
            <button mat-raised-button class="text-left" *ngIf="!registratorOn" type="button" (click)="addRegistrator()">Registrator</button>
          </div>
          <div class="d-flex flex-column pt-3">

          </div>
        </mat-card-content>
      </mat-card>
    </div>
  </div>


  <div class="container main-container">
    <!--DEED REFERENCES-->
    <div class="card shadow mb-3">
      <div class="card-body">
        <div class="text-center">
          <h3>
            <i class="fa fa-info-circle"></i> Deed Information</h3>
          <hr class="mt-2 mb-2">
        </div>
        <div class="row">
          <div class="form-group col">
            <label>Deed Code
              <small class="text-danger pl-2" *ngIf="deedForm.controls.deedCode.errors">This field is required</small>
            </label>
            <div class="input-group">
              <input class="form-control" formControlName="deedCode" placeholder="fond-opis-delo-list" trim="blur" required>
              <span class="input-group-btn">
                <button type="button" (click)="insertLastDeedCode()" class="btn btn-secondary" matTooltip="Click to insert the code of the last deed saved in the database">
                  <i class="fa fa-arrow-circle-o-down" aria-hidden="true"></i> Code</button>
              </span>
            </div>
          </div>
          <div class="form-group col">
            <label>Deed Reference
              <small class="text-danger pl-2" *ngIf="deedForm.controls.deedRef.errors">This field is required</small>
            </label>
            <div class="input-group">
              <input class="form-control" formControlName="deedRef" placeholder="scan number" trim="blur" required>
              <span class="input-group-btn">
                <button type="button" (click)="insertLastDeedRef()" class="btn btn-secondary" matTooltip="Click to insert the reference of the last deed saved in the database">
                  <i class="fa fa-arrow-circle-o-down" aria-hidden="true"></i> Ref.</button>
              </span>
            </div>
          </div>
          <div class="form-group col" formGroupName="deedDate">
            <label>Deed Date
              <small class="pl-2">Format: 31-12-2017</small>
            </label>
            <div class="row no-gutters">
              <div class="col">
                <input type="text" class="form-control" formControlName="day" placeholder="day" trim="blur">
              </div>
              <div class="col">
                <input type="text" class="form-control" formControlName="month" placeholder="month" trim="blur">
              </div>
              <div class="col">
                <input type="text" class="form-control" formControlName="year" placeholder="year" trim="blur">
              </div>
              <div class="col">
                <button type="button" (click)="insertLastDeedDate()" class="btn btn-secondary" matTooltip="Click to insert the date of the last deed saved in the database">
                  <i class="fa fa-arrow-circle-o-down" aria-hidden="true"></i> Date</button>
              </div>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="form-group col-8">
            <label>Deed Name</label>
            <input type="text" class="form-control" formControlName="deedName">
          </div>
          <div class="form-group col-4">
            <label>Deed Language</label>
            <input type="text" class="form-control" formControlName="deedLanguage" trim="blur">
          </div>
        </div>
      </div>
    </div>
    <!-- CONTRACTING PARTIES -->
    <div class="card shadow mb-3">
      <div class="card-body">
        <div class="text-center">
          <h3>
            <i class="fa fa-users"></i> Contracting Parties</h3>
          <hr class="mt-2 mb-2">
        </div>
        <!-- Main Agent -->
        <div class="card mb-3">
          <div class="card-header">
            <h4 class="text-center">Agent</h4>
          </div>
          <div class="card-body">
            <div class="form-group">
              <label>Agent Type</label>
              <div>
                <select class="form-control" formControlName="agentSex" (change)="updateAgent()">
                  <option *ngFor="let gen of gender" [value]="gen">{{gen}}</option>
                </select>
              </div>
            </div>
            <div [ngSwitch]="getAgentSex()">
              <div *ngSwitchCase="'male'">
                <div formGroupName="agent">
                  <div class="row">
                    <div class="form-group col">
                      <label>Geogr Status</label>
                      <input class="form-control" formControlName="geogrStatus" [typeahead]="geogrStatusesSorted" [typeaheadMinLength]="2" [typeaheadScrollable]="true" [typeaheadOptionsInScrollableView]="8" trim="blur">
                    </div>
                    <div class="form-group col">
                      <label>Social Status</label>
                      <input type="text" class="form-control" formControlName="socialStatus" trim="blur">
                    </div>
                  </div>
                  <div class="row">
                    <div class="form-group col">
                      <label>First Name</label>
                      <input type="text" class="form-control" formControlName="firstName" [typeahead]="firstNamesMaleSorted"  [typeaheadMinLength]="0" [typeaheadScrollable]="true" [typeaheadOptionsInScrollableView]="8" trim="blur">
                    </div>
                    <div class="form-group col">
                      <label>Patronyme</label>
                      <input type="text" class="form-control" formControlName="patronyme" trim="blur">
                    </div>
                  </div>
                  <div class="row">
                    <div class="form-group col">
                      <label>Last Name</label>
                      <input type="text" class="form-control" formControlName="lastName" trim="blur">
                    </div>
                    <div class="form-group col">
                      <label>Related To</label>
                      <input type="text" class="form-control" formControlName="relatedTo" trim="blur">
                    </div>
                  </div>
                </div>
              </div>
              <div *ngSwitchCase="'female'">
                <div formGroupName="agent">
                  <div class="row">
                    <div class="form-grou col">
                      <label>Family Status</label>
                      <input type="text" class="form-control" formControlName="familyStatus" trim="blur">
                    </div>
                    <div class="form-group col">
                      <label>First Name</label>
                      <input type="text" class="form-control" formControlName="firstName" [typeahead]="firstNamesFemaleSorted"  [typeaheadMinLength]="0" [typeaheadScrollable]="true" [typeaheadOptionsInScrollableView]="8" trim="blur">
                    </div>
                  </div>
                  <div class="row">
                    <div class="form-group col">
                      <label>Patronyme</label>
                      <input type="text" class="form-control" formControlName="patronyme" trim="blur">
                    </div>
                    <div class="form-group col">
                      <label>Related To</label>
                      <input type="text" class="form-control" formControlName="relatedTo" trim="blur">
                    </div>
                  </div>
                  <div class="card mb-3" formGroupName="referentMale">
                    <div class="card-header">
                      <h5 class="text-center">Referent Male</h5>
                    </div>
                    <div class="card-body">
                      <div class="row">
                        <div class="form-group col">
                          <label>Relationship To Agent</label>
                          <input type="text" class="form-control" formControlName="relationshipToAgent" trim="blur">
                        </div>
                        <div class="form-group col">
                          <label>Geogr Status</label>
                          <input type="text" class="form-control" formControlName="geogrStatus" [typeahead]="geogrStatusesSorted" [typeaheadMinLength]="2" [typeaheadScrollable]="true" [typeaheadOptionsInScrollableView]="8" trim="blur">
                        </div>
                        <div class="form-group col">
                          <label>Social Status</label>
                          <input type="text" class="form-control" formControlName="socialStatus" trim="blur">
                        </div>
                      </div>
                      <div class="row">
                        <div class="form-group col">
                          <label>First Name</label>
                          <input type="text" class="form-control" formControlName="firstName" trim="blur">
                        </div>
                        <div class="form-group col">
                          <label>Patronyme</label>
                          <input type="text" class="form-control" formControlName="patronyme" trim="blur">
                        </div>
                      </div>
                      <div class="row">
                        <div class="form-group col">
                          <label>Last Name</label>
                          <input type="text" class="form-control" formControlName="lastName" trim="blur">
                        </div>
                        <div class="form-group col">
                          <label>Related To</label>
                          <input type="text" class="form-control" formControlName="relatedTo" trim="blur">
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div *ngSwitchCase="'body-corporate'">
                <div formGroupName="agent">
                  <div class="row">
                    <div class="form-group col">
                      <label>Geogr Status</label>
                      <input type="text" class="form-control" formControlName="geogrStatus" [typeahead]="geogrStatusesSorted" [typeaheadMinLength]="2" [typeaheadScrollable]="true" [typeaheadOptionsInScrollableView]="8" trim="blur">
                    </div>
                    <div class="form-group col">
                      <label>Social Status</label>
                      <select class="form-control" formControlName="socialStatus" (change)="updateSocialStatusAgent()">
                        <option *ngFor="let social of socialBody" [value]="social">{{social}}</option>
                      </select>
                    </div>
                  </div>
                  <div class="row">
                    <div *ngIf="updateSocialStatusAgent()" class="form-group col">
                      <label>Other Social status</label>
                      <input type="text" class="form-control" formControlName="otherSocialStatus" trim="blur">
                    </div>
                  </div>
                  <div class="row">
                    <div class="form-group col-8">
                      <label>Corporation Name</label>
                      <input type="text" class="form-control" formControlName="corporationName" trim="blur">
                    </div>
                    <div class="form-group col-4">
                      <label>Number of Participants</label>
                      <input type="number" min="0" class="form-control" formControlName="nbParticipants" trim="blur">
                    </div>
                  </div>
                  <div class="row">
                    <div class="form-group col">
                      <label>Names</label>
                      <textarea class="form-control" formControlName="names" trim="blur"></textarea>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!--Co Agents -->
        <div formArrayName="coAgents">
          <div *ngFor="let coAgent of deedForm['controls'].coAgents['controls']; let i=index" class="card mb-3">
            <div class="card-header teal lighten-4">
              <div class="row justify-content-end">
                <div class="col-4">
                  <h4 class="text-center">Co-Agent {{i + 1}}</h4>
                </div>
                <div class="col-4">
                  <h4>
                    <i class="fa fa-times pull-right" (click)="removeCoAgent(i)" aria-hidden="true"></i>
                  </h4>
                </div>
              </div>
            </div>
            <div class="card-body" [formGroupName]="i">
              <div class="row">
                <div class="form-group col">
                  <label>Co-Agent Type</label>
                  <select class="form-control" formControlName="coAgentSex" (change)="updateCoAgent(i)">
                    <option *ngFor="let gen of gender" [value]="gen">{{gen}}</option>
                  </select>
                </div>
              </div>
              <div [ngSwitch]="getCoAgentSex(i)">
                <div *ngSwitchCase="'male'">
                  <div formGroupName="coAgent">
                    <div class="row">
                      <div class="form-group col">
                        <label>Geogr Status</label>
                        <input type="text" class="form-control" formControlName="geogrStatus" [typeahead]="geogrStatusesSorted" [typeaheadMinLength]="2" [typeaheadScrollable]="true" [typeaheadOptionsInScrollableView]="8" trim="blur">
                      </div>
                      <div class="form-group col">
                        <label>Social Status</label>
                        <input type="text" class="form-control" formControlName="socialStatus" trim="blur">
                      </div>
                    </div>
                    <div class="row">
                      <div class="form-group col">
                        <label>First Name</label>
                        <input type="text" class="form-control" formControlName="firstName" trim="blur" [typeahead]="firstNamesMaleSorted"  [typeaheadMinLength]="0" [typeaheadScrollable]="true" [typeaheadOptionsInScrollableView]="8">
                      </div>
                      <div class="form-group col">
                        <label>Patronyme</label>
                        <input type="text" class="form-control" formControlName="patronyme" trim="blur">
                      </div>
                    </div>
                    <div class="row">
                      <div class="form-group col">
                        <label>Last Name</label>
                        <input type="text" class="form-control" formControlName="lastName" trim="blur">
                      </div>
                      <div class="form-group col">
                        <label>Related To</label>
                        <input type="text" class="form-control" formControlName="relatedTo" trim="blur">
                      </div>
                    </div>
                  </div>
                </div>
                <div *ngSwitchCase="'female'">
                  <div formGroupName="coAgent">
                    <div class="row">
                      <div class="form-group col">
                        <label>Family Status</label>
                        <input type="text" class="form-control" formControlName="familyStatus" trim="blur">
                      </div>
                      <div class="form-group col">
                        <label>First Name</label>
                        <input type="text" class="form-control" formControlName="firstName" trim="blur" [typeahead]="firstNamesFemaleSorted"  [typeaheadMinLength]="0" [typeaheadScrollable]="true" [typeaheadOptionsInScrollableView]="8">
                      </div>
                    </div>
                    <div class="row">
                      <div class="form-group col">
                        <label>Patronyme</label>
                        <input type="text" class="form-control" formControlName="patronyme" trim="blur">
                      </div>
                      <div class="form-group col">
                        <label>Related To</label>
                        <input type="text" class="form-control" formControlName="relatedTo" trim="blur">
                      </div>
                    </div>
                    <div class="card mb-3" formGroupName="referentMale">
                      <div class="card-header">
                        <div class="row justify-content-end">
                          <div class="col-4">
                            <h5 class="text-center">Referent Male</h5>
                          </div>
                          <div class="col-4">
                            <button type="button" (click)="insertAgentData(i)" class="btn btn-info btn-sm pull-right" placement="bottom" ngbTooltip="Click if the Referent Male is the Agent">
                              <i class="fa fa-arrow-down" aria-hidden="true"></i> Agent data</button>
                          </div>
                        </div>
                      </div>
                      <div class="card-body">
                        <div class="row">
                          <div class="form-group col">
                            <label>Relationship To coAgent</label>
                            <input type="text" class="form-control" formControlName="relationshipToCoAgent" trim="blur">
                          </div>
                          <div class="form-group col">
                            <label>Geogr Status</label>
                            <input type="text" class="form-control" formControlName="geogrStatus" [typeahead]="geogrStatusesSorted" [typeaheadMinLength]="2" [typeaheadScrollable]="true" [typeaheadOptionsInScrollableView]="8" trim="blur">
                          </div>
                          <div class="form-group col">
                            <label>Social Status</label>
                            <input type="text" class="form-control" formControlName="socialStatus" trim="blur">
                          </div>
                        </div>
                        <div class="row">
                          <div class="form-group col">
                            <label>First Name</label>
                            <input type="text" class="form-control" formControlName="firstName" trim="blur" [typeahead]="firstNamesMaleSorted"  [typeaheadMinLength]="0" [typeaheadScrollable]="true" [typeaheadOptionsInScrollableView]="8">
                          </div>
                          <div class="form-group col">
                            <label>Patronyme</label>
                            <input type="text" class="form-control" formControlName="patronyme" trim="blur">
                          </div>
                        </div>
                        <div class="row">
                          <div class="form-group col">
                            <label>Last Name</label>
                            <input type="text" class="form-control" formControlName="lastName" trim="blur">
                          </div>
                          <div class="form-group col">
                            <label>Related To</label>
                            <input type="text" class="form-control" formControlName="relatedTo" trim="blur">
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div *ngSwitchCase="'body-corporate'">
                  <div formGroupName="coAgent">
                    <div class="row">
                      <div class="form-group col">
                        <label>Geogr Status</label>
                        <input type="text" class="form-control" formControlName="geogrStatus" [typeahead]="geogrStatusesSorted" [typeaheadMinLength]="2" [typeaheadScrollable]="true" [typeaheadOptionsInScrollableView]="8" trim="blur">
                      </div>
                      <div class="form-group col">
                        <label>Social Status</label>
                        <select class="form-control" formControlName="socialStatus" (change)="updateSocialStatusCoAgent()">
                          <option *ngFor="let social of socialBody" [value]="social">{{social}}</option>
                        </select>
                      </div>
                    </div>
                    <div class="row">
                      <div *ngIf="updateSocialStatusCoAgent()" class="form-group col">
                        <label>Other Social status</label>
                        <input type="text" class="form-control" formControlName="otherSocialStatus" trim="blur">
                      </div>
                    </div>
                    <div class="row">
                      <div class="form-group col-8">
                        <label>Corporation Name</label>
                        <input type="text" class="form-control" formControlName="corporationName" trim="blur">
                      </div>
                      <div class="form-group col-4">
                        <label>Number of Participants</label>
                        <input type="number" min="0" class="form-control" formControlName="nbParticipants" trim="blur">
                      </div>
                    </div>
                    <div class="row">
                      <div class="form-group col">
                        <label>Names</label>
                        <textarea class="form-control" formControlName="names" trim="blur"></textarea>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- END Card block -->
          </div>
          <!-- END card -->
        </div>
        <!-- END formArrayName -->
        <div *ngIf="collectiveCoAgentOn">
          <div formGroupName="collectiveCoAgent" class="card mb-3">
            <div class="card-header teal lighten-5">
              <div class="row justify-content-end">
                <div class="col-4">
                  <h4 class="text-center">Collective Co-Agent</h4>
                </div>
                <div class="col-4">
                  <h4>
                    <i class="fa fa-times pull-right" (click)="removeCollectiveCoAgent()" aria-hidden="true"></i>
                  </h4>
                </div>
              </div>
            </div>
            <div class="card-body">
              <div class="form-group">
                <label>Relation To Agent</label>
                <select class="form-control" formControlName="relationToAgent" (change)="updateRelationToAgent()">
                  <option *ngFor="let relation of relationtoagents" [value]="relation">{{relation}}</option>
                </select>
              </div>
              <div *ngIf="updateRelationToAgent()" class="form-group">
                <label>Other Relation to Agent</label>
                <input type="text" class="form-control" formControlName="otherRelationToAgent" trim="blur">
              </div>
              <div class="form-group">
                <label>Number of Participants</label>
                <input type="number" min="0" class="form-control" formControlName="numberOfParticipants" trim="blur">
              </div>
              <div class="form-group">
                <label>Statuses and Names</label>
                <input type="text" class="form-control" formControlName="statusesNames" trim="blur">
              </div>
            </div>
          </div>
        </div>

        <mat-toolbar class="mb-3">
          <div class="action-button">
            <button mat-raised-button type="button" (click)="addCoAgent()">Co-Agent</button>
            <button mat-raised-button *ngIf="!collectiveCoAgentOn" (click)="addCollectiveCoAgent()" type="button">Collective Co-Agent</button>
          </div>
        </mat-toolbar>


        <!-- Main Counter Agent -->

        <div class="card mb-3">
          <div class="card-header amber lighten-3">
            <h4 class="text-center">Counter Agent</h4>
          </div>
          <div class="card-body">
            <div class="form-group">
              <label>Counter Agent Type</label>
              <div>
                <select class="form-control" formControlName="counterAgentSex" (change)="updateCounterAgent()">
                  <option *ngFor="let gen of gender" [value]="gen">{{gen}}</option>
                </select>
              </div>
            </div>
            <div [ngSwitch]="getCounterAgentSex()">
              <div *ngSwitchCase="'male'">
                <div formGroupName="counterAgent">
                  <div class="row">
                    <div class="form-group col">
                      <label>Geogr Status</label>
                      <input class="form-control" formControlName="geogrStatus" [typeahead]="geogrStatusesSorted" [typeaheadMinLength]="2" [typeaheadScrollable]="true" [typeaheadOptionsInScrollableView]="8" trim="blur">
                    </div>
                    <div class="form-group col">
                      <label>Social Status</label>
                      <input type="text" class="form-control" formControlName="socialStatus" trim="blur">
                    </div>
                  </div>
                  <div class="row">
                    <div class="form-group col">
                      <label>First Name</label>
                      <input type="text" class="form-control" formControlName="firstName" trim="blur" [typeahead]="firstNamesMaleSorted"  [typeaheadMinLength]="0" [typeaheadScrollable]="true" [typeaheadOptionsInScrollableView]="8">
                    </div>
                    <div class="form-group col">
                      <label>Patronyme</label>
                      <input type="text" class="form-control" formControlName="patronyme" trim="blur">
                    </div>
                  </div>
                  <div class="row">
                    <div class="form-group col">
                      <label>Last Name</label>
                      <input type="text" class="form-control" formControlName="lastName" trim="blur">
                    </div>
                    <div class="form-group col">
                      <label>Related To</label>
                      <input type="text" class="form-control" formControlName="relatedTo" trim="blur">
                    </div>
                  </div>
                </div>
              </div>
              <div *ngSwitchCase="'female'">
                <div formGroupName="counterAgent">
                  <div class="row">
                    <div class="form-grou col">
                      <label>Family Status</label>
                      <input type="text" class="form-control" formControlName="familyStatus" trim="blur">
                    </div>
                    <div class="form-group col">
                      <label>First Name</label>
                      <input type="text" class="form-control" formControlName="firstName" trim="blur" [typeahead]="firstNamesFemaleSorted"  [typeaheadMinLength]="0" [typeaheadScrollable]="true" [typeaheadOptionsInScrollableView]="8">
                    </div>
                  </div>
                  <div class="row">
                    <div class="form-group col">
                      <label>Patronyme</label>
                      <input type="text" class="form-control" formControlName="patronyme" trim="blur">
                    </div>
                    <div class="form-group col">
                      <label>Related To</label>
                      <input type="text" class="form-control" formControlName="relatedTo" trim="blur">
                    </div>
                  </div>
                  <div class="card mb-3" formGroupName="referentMale">
                    <div class="card-header">
                      <h5 class="text-center">Referent Male</h5>
                    </div>
                    <div class="card-body">
                      <div class="row">
                        <div class="form-group col">
                          <label>Relationship To Counter Agent</label>
                          <input type="text" class="form-control" formControlName="relationshipToCounterAgent" trim="blur">
                        </div>
                        <div class="form-group col">
                          <label>Geogr Status</label>
                          <input type="text" class="form-control" formControlName="geogrStatus" [typeahead]="geogrStatusesSorted" [typeaheadMinLength]="2" [typeaheadScrollable]="true" [typeaheadOptionsInScrollableView]="8" trim="blur">
                        </div>
                        <div class="form-group col">
                          <label>Social Status</label>
                          <input type="text" class="form-control" formControlName="socialStatus" trim="blur">
                        </div>
                      </div>
                      <div class="row">
                        <div class="form-group col">
                          <label>First Name</label>
                          <input type="text" class="form-control" formControlName="firstName" trim="blur" [typeahead]="firstNamesMaleSorted"  [typeaheadMinLength]="0" [typeaheadScrollable]="true" [typeaheadOptionsInScrollableView]="8">
                        </div>
                        <div class="form-group col">
                          <label>Patronyme</label>
                          <input type="text" class="form-control" formControlName="patronyme" trim="blur">
                        </div>
                      </div>
                      <div class="row">
                        <div class="form-group col">
                          <label>Last Name</label>
                          <input type="text" class="form-control" formControlName="lastName" trim="blur">
                        </div>
                        <div class="form-group col">
                          <label>Related To</label>
                          <input type="text" class="form-control" formControlName="relatedTo" trim="blur">
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div *ngSwitchCase="'body-corporate'">
                <div formGroupName="counterAgent">
                  <div class="row">
                    <div class="form-group col">
                      <label>Geogr Status</label>
                      <input type="text" class="form-control" formControlName="geogrStatus" [typeahead]="geogrStatusesSorted" [typeaheadMinLength]="2" [typeaheadScrollable]="true" [typeaheadOptionsInScrollableView]="8" trim="blur">
                    </div>
                    <div class="form-group col">
                      <label>Social Status</label>
                      <select class="form-control" formControlName="socialStatus" (change)="updateSocialStatusCounterAgent()">
                        <option *ngFor="let social of socialBody" [value]="social">{{social}}</option>
                      </select>
                    </div>
                  </div>
                  <div class="row">
                    <div *ngIf="updateSocialStatusCounterAgent()" class="form-group col">
                      <label>Other Social status</label>
                      <input type="text" class="form-control" formControlName="otherSocialStatus" trim="blur">
                    </div>
                  </div>
                  <div class="row">
                    <div class="form-group col-8">
                      <label>Corporation Name</label>
                      <input type="text" class="form-control" formControlName="corporationName" trim="blur">
                    </div>
                    <div class="form-group col-4">
                      <label>Number of Participants</label>
                      <input type="number" min="0" class="form-control" formControlName="nbParticipants" trim="blur">
                    </div>
                  </div>
                  <div class="row">
                    <div class="form-group col">
                      <label>Names</label>
                      <textarea class="form-control" formControlName="names" trim="blur"></textarea>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!--Co Counter Agents -->
        <div formArrayName="coCounterAgents">
          <div *ngFor="let coCounterAgent of deedForm['controls'].coCounterAgents['controls']; let i=index" class="card mb-3">
            <div class="card-header amber lighten-4">
              <div class="row justify-content-end">
                <div class="col-4">
                  <h4 class="text-center">Co-Counter Agent {{i + 1}}</h4>
                </div>
                <div class="col-4">
                  <h4>
                    <i class="fa fa-times pull-right" (click)="removeCoCounterAgent(i)" aria-hidden="true"></i>
                  </h4>
                </div>
              </div>
            </div>
            <div class="card-body" [formGroupName]="i">
              <div class="row">
                <div class="form-group col">
                  <label>Co-Counter Agent Type</label>
                  <select class="form-control" formControlName="coCounterAgentSex" (change)="updateCoCounterAgent(i)">
                    <option *ngFor="let gen of gender" [value]="gen">{{gen}}</option>
                  </select>
                </div>
              </div>
              <div [ngSwitch]="getCoCounterAgentSex(i)">
                <div *ngSwitchCase="'male'">
                  <div formGroupName="coCounterAgent">
                    <div class="row">
                      <div class="form-group col">
                        <label>Geogr Status</label>
                        <input type="text" class="form-control" formControlName="geogrStatus" [typeahead]="geogrStatusesSorted" [typeaheadMinLength]="2" [typeaheadScrollable]="true" [typeaheadOptionsInScrollableView]="8" trim="blur">
                      </div>
                      <div class="form-group col">
                        <label>Social Status</label>
                        <input type="text" class="form-control" formControlName="socialStatus" trim="blur">
                      </div>
                    </div>
                    <div class="row">
                      <div class="form-group col">
                        <label>First Name</label>
                        <input type="text" class="form-control" formControlName="firstName" trim="blur" [typeahead]="firstNamesMaleSorted"  [typeaheadMinLength]="0" [typeaheadScrollable]="true" [typeaheadOptionsInScrollableView]="8">
                      </div>
                      <div class="form-group col">
                        <label>Patronyme</label>
                        <input type="text" class="form-control" formControlName="patronyme" trim="blur">
                      </div>
                    </div>
                    <div class="row">
                      <div class="form-group col">
                        <label>Last Name</label>
                        <input type="text" class="form-control" formControlName="lastName" trim="blur">
                      </div>
                      <div class="form-group col">
                        <label>Related To</label>
                        <input type="text" class="form-control" formControlName="relatedTo" trim="blur">
                      </div>
                    </div>
                  </div>
                </div>
                <div *ngSwitchCase="'female'">
                  <div formGroupName="coCounterAgent">
                    <div class="row">
                      <div class="form-group col">
                        <label>Family Status</label>
                        <input type="text" class="form-control" formControlName="familyStatus" trim="blur">
                      </div>
                      <div class="form-group col">
                        <label>First Name</label>
                        <input type="text" class="form-control" formControlName="firstName" trim="blur" [typeahead]="firstNamesFemaleSorted"  [typeaheadMinLength]="0" [typeaheadScrollable]="true" [typeaheadOptionsInScrollableView]="8">
                      </div>
                    </div>
                    <div class="row">
                      <div class="form-group col">
                        <label>Patronyme</label>
                        <input type="text" class="form-control" formControlName="patronyme" trim="blur">
                      </div>
                      <div class="form-group col">
                        <label>Related To</label>
                        <input type="text" class="form-control" formControlName="relatedTo" trim="blur">
                      </div>
                    </div>
                    <div class="card mb-3" formGroupName="referentMale">
                      <div class="card-header">
                        <div class="row justify-content-end">
                          <div class="col-4">
                            <h5 class="text-center">Referent Male</h5>
                          </div>
                          <div class="col-4">
                            <button type="button" (click)="insertCounterAgentData(i)" class="btn btn-info btn-sm pull-right" placement="bottom" ngbTooltip="Click if the Referent Male is the Counter Agent">
                              <i class="fa fa-arrow-down" aria-hidden="true"></i> Counter Agent data</button>
                          </div>
                        </div>
                      </div>
                      <div class="card-body">
                        <div class="row">
                          <div class="form-group col">
                            <label>Relationship To Co-Counter Agent</label>
                            <input type="text" class="form-control" formControlName="relationshipToCoCounterAgent" trim="blur">
                          </div>
                          <div class="form-group col">
                            <label>Geogr Status</label>
                            <input type="text" class="form-control" formControlName="geogrStatus" [typeahead]="geogrStatusesSorted" [typeaheadMinLength]="2" [typeaheadScrollable]="true" [typeaheadOptionsInScrollableView]="8" trim="blur">
                          </div>
                          <div class="form-group col">
                            <label>Social Status</label>
                            <input type="text" class="form-control" formControlName="socialStatus" trim="blur">
                          </div>
                        </div>
                        <div class="row">
                          <div class="form-group col">
                            <label>First Name</label>
                            <input type="text" class="form-control" formControlName="firstName" trim="blur" [typeahead]="firstNamesMaleSorted"  [typeaheadMinLength]="0" [typeaheadScrollable]="true" [typeaheadOptionsInScrollableView]="8">
                          </div>
                          <div class="form-group col">
                            <label>Patronyme</label>
                            <input type="text" class="form-control" formControlName="patronyme" trim="blur">
                          </div>
                        </div>
                        <div class="row">
                          <div class="form-group col">
                            <label>Last Name</label>
                            <input type="text" class="form-control" formControlName="lastName" trim="blur">
                          </div>
                          <div class="form-group col">
                            <label>Related To</label>
                            <input type="text" class="form-control" formControlName="relatedTo" trim="blur">
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div *ngSwitchCase="'body-corporate'">
                  <div formGroupName="coCounterAgent">
                    <div class="row">
                      <div class="form-group col">
                        <label>Geogr Status</label>
                        <input type="text" class="form-control" formControlName="geogrStatus" [typeahead]="geogrStatusesSorted" [typeaheadMinLength]="2" [typeaheadScrollable]="true" [typeaheadOptionsInScrollableView]="8" trim="blur">
                      </div>
                      <div class="form-group col">
                        <label>Social Status</label>
                        <select class="form-control" formControlName="socialStatus" (change)="updateSocialStatusCoCounterAgent()">
                          <option *ngFor="let social of socialBody" [value]="social">{{social}}</option>
                        </select>
                      </div>
                    </div>
                    <div class="row">
                      <div *ngIf="updateSocialStatusCoCounterAgent()" class="form-group col">
                        <label>Other Social status</label>
                        <input type="text" class="form-control" formControlName="otherSocialStatus" trim="blur">
                      </div>
                    </div>
                    <div class="row">
                      <div class="form-group col-8">
                        <label>Corporation Name</label>
                        <input type="text" class="form-control" formControlName="corporationName" trim="blur">
                      </div>
                      <div class="form-group col-4">
                        <label>Number of Participants</label>
                        <input type="text" class="form-control" formControlName="nbParticipants" trim="blur">
                      </div>
                    </div>
                    <div class="row">
                      <div class="form-group col">
                        <label>Names</label>
                        <textarea class="form-control" formControlName="names" trim="blur"></textarea>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- END Card block -->
          </div>
          <!-- END card -->
        </div>
        <!-- END formArrayName -->
        <div *ngIf="collectiveCoCounterAgentOn">
          <div formGroupName="collectiveCoCounterAgent" class="card mb-3">
            <div class="card-header amber lighten-5">
              <div class="row justify-content-end">
                <div class="col-4">
                  <h4 class="text-center">Collective Co-Counter Agent</h4>
                </div>
                <div class="col-4">
                  <h4>
                    <i class="fa fa-times pull-right" (click)="removeCollectiveCoCounterAgent()" aria-hidden="true"></i>
                  </h4>
                </div>
              </div>
            </div>
            <div class="card-body">
              <div class="form-group">
                <label>Relation To Counter Agent</label>
                <select class="form-control" formControlName="relationToCounterAgent" (change)="updateRelationToCounterAgent()">
                  <option *ngFor="let relation of relationtoagents" [value]="relation">{{relation}}</option>
                </select>
              </div>
              <div *ngIf="updateRelationToCounterAgent()" class="form-group">
                <label>Other Relation to Counter Agent</label>
                <input type="text" class="form-control" formControlName="otherRelationToCounterAgent" trim="blur">
              </div>
              <div class="form-group">
                <label>Number of Participants</label>
                <input type="number" min="0" class="form-control" formControlName="numberOfParticipants" trim="blur">
              </div>
              <div class="form-group">
                <label>Statuses and Names</label>
                <input type="text" class="form-control" formControlName="statusesNames" trim="blur">
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- TRANSACTION -->
    <div class="card shadow mb-3">
      <div class="card-body">
        <div class="text-center">
          <h3>
            <i class="fa fa-handshake-o"></i> Transactions</h3>
          <hr class="mt-2 mb-2">
        </div>

        <div formArrayName="transactions">
          <div *ngFor="let transaction of deedForm['controls']['transactions']['controls']; let i=index" class="card mb-3">
            <div class="card-header light-blue lighten-3">
              <div class="row justify-content-end">
                <div class="col-4">
                  <h4 class="text-center">Transaction {{i + 1}}</h4>
                </div>
                <div class="col-4">
                  <h4>
                    <i *ngIf="deedForm['controls']['transactions']['controls'].length > 1" class="fa fa-times pull-right" (click)="removeTransaction(i)"
                      aria-hidden="true"></i>
                  </h4>
                </div>
              </div>
            </div>

            <div class="card-body" [formGroupName]="i">

              <!-- AGENT TRANSACTION -->

              <div class="form-group">
                <label>What the Agent does ?</label>
                <select class="form-control" formControlName="agentAction" (change)="updateAgentAction(i)">
                  <option *ngFor="let action of agentActionsList" [value]="action">{{ action }}</option>
                </select>
              </div>
              <div [ngSwitch]="selectedAction">
                <div *ngSwitchCase="'other'">
                  <div class="form-group">
                    <label>Other Agent Action</label>
                    <input type="text" class="form-control" formControlName="otherAgentAction" trim="blur">
                  </div>
                </div>
                <div *ngSwitchCase="'what'">
                  <div class="form-group">
                    <label>What ?</label>
                    <select class="form-control" formControlName="agentTransactionObjectType" (change)="selectedWhat(i)">
                      <option *ngFor="let what of whatList" [value]="what">{{ what }}</option>
                    </select>
                  </div>
                </div>
                <div *ngSwitchCase="'bequeaths'">
                  <div class="form-group">
                    <label>What ?</label>
                    <select class="form-control" formControlName="agentTransactionObjectType" (change)="selectedWhat(i)">
                      <option *ngFor="let what of whatList" [value]="what">{{ what }}</option>
                    </select>
                  </div>
                </div>
                <div *ngSwitchCase="'whom'">
                  <div class="form-group">
                    <label>Whom ?</label>
                    <select class="form-control" #whom (change)="selectedWhom(whom.value, i)">
                      <option *ngFor="let whom of whomList" [value]="whom">{{ whom }}</option>
                    </select>
                  </div>
                </div>
                <div *ngSwitchCase="'asWhom'">
                  <div class="form-group">
                    <label>As Whom ?</label>
                    <select class="form-control" #aswhom (change)="selectedAsWhom(i, aswhom.value)">
                      <option *ngFor="let asWhom of asWhomList" [value]="asWhom">{{ asWhom }}</option>
                    </select>
                  </div>
                </div>
                <div *ngSwitchCase="'settles'">
                  <div class="form-group">
                    <label>Accusation against Agent</label>
                    <input type="text" class="form-control" formControlName="accusationAgainstAgent">
                  </div>
                </div>

              </div>
              <!-- AGENT TRANSACTION OBJETCS -->
              <div formArrayName='agentTransactionObjects'>
                <div *ngFor="let transactionObject of transaction['controls']['agentTransactionObjects']['controls']; let j=index">
                  <div [formGroupName]="j">
                    <div *ngIf="transactionObject['controls']['chattels']" class="card mb-3">
                      <div class="card-header">
                        <div class="row justify-content-end">
                          <div class="col-4">
                            <h5 class="text-center">Chattels</h5>
                          </div>
                          <div class="col-4">
                            <h5>
                              <i class="fa fa-times pull-right" (click)="removeAgentTransactionObject(i, j)" aria-hidden="true"></i>
                            </h5>
                          </div>
                        </div>
                      </div>
                      <div formGroupName="chattels" class="card-body">
                        <div class="row">
                          <div class="form-group col">
                            <label>Type</label>
                            <input type="text" class="form-control" formControlName="type" trim="blur">
                          </div>
                          <div class="form-group col">
                            <label>Origin</label>
                            <input type="text" class="form-control" formControlName="origin" trim="blur">
                          </div>
                        </div>
                        <div class="row">
                          <div class="form-group col-12">
                            <label>Description</label>
                            <input type="text" class="form-control" formControlName="description" trim="blur">
                          </div>
                        </div>
                        <div class="row">
                          <div class="form-group col-12">
                            <div formArrayName="price">
                              <label>Price in</label>
                              <div *ngFor="let priceChattel of transactionObject['controls']['chattels']['controls']['price']['controls']; let k=index">
                                <div [formGroupName]="k">
                                        <div class="form-group">
                                          <div class="row">
                                            <div class="col-2">
                                              <select class="form-control" formControlName="coins">
                                                  <option value="unspecified">Unspecified</option>
                                                  <option value="silver">Silver</option>
                                                  <option value="copper">Copper</option>
                                                  <option value="chekhi">Chekhi</option>
                                              </select>
                                            </div>
                                            <div class="col-2">
                                              <input type="number" min="0" class="form-control" formControlName="rubli" trim="blur">
                                            </div>
                                            <div class="col-1 small-label">rubli</div>
                                            <div class="col-2">
                                              <input type="number" min="0" class="form-control" formControlName="altyny" trim="blur">
                                            </div>
                                            <div class="col-1 small-label">altyny</div>
                                            <div class="col-2">
                                              <input type="number" min="0" class="form-control" formControlName="dengi" trim="blur">
                                            </div>
                                            <div class="col-1 small-label">den'gi</div>
                                            <div class="col-1">
                                              <i class="fas fa-plus-circle mr-2" (click)="addMoneyChattelsAgent(i, j)" aria-hidden="true"></i>
                                              <i class="fas fa-ban" (click)="removeMoneyChattelsAgent(i, j, k)" aria-hidden="true"></i>
                                            </div>
                                          </div>
                                      </div>
                                  </div>
                                </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div *ngIf="transactionObject['controls']['debt']" class="card mb-3">
                      <div class="card-header">
                        <div class="row justify-content-end">
                          <div class="col-4">
                            <h5 class="text-center">Debt</h5>
                          </div>
                          <div class="col-4">
                            <h5>
                              <i class="fa fa-times pull-right" (click)="removeAgentTransactionObject(i, j)" aria-hidden="true"></i>
                            </h5>
                          </div>
                        </div>
                      </div>
                      <div formGroupName="debt" class="card-body">
                        <div formArrayName="amount">
                          <label>Amount in</label>
                          <div *ngFor="let amountDebt of transactionObject['controls']['debt']['controls']['amount']['controls']; let k=index">
                            <div [formGroupName]="k">
                                    <div class="form-group">
                                      <div class="row">
                                        <div class="col-2">
                                          <select class="form-control" formControlName="coins">
                                              <option value="unspecified">Unspecified</option>
                                              <option value="silver">Silver</option>
                                              <option value="copper">Copper</option>
                                              <option value="chekhi">Chekhi</option>
                                          </select>
                                        </div>
                                        <div class="col-2">
                                          <input type="number" min="0" class="form-control" formControlName="rubli" trim="blur">
                                        </div>
                                        <div class="col-1 small-label">rubli</div>
                                        <div class="col-2">
                                          <input type="number" min="0" class="form-control" formControlName="altyny" trim="blur">
                                        </div>
                                        <div class="col-1 small-label">altyny</div>
                                        <div class="col-2">
                                          <input type="number" min="0" class="form-control" formControlName="dengi" trim="blur">
                                        </div>
                                        <div class="col-1 small-label">den'gi</div>
                                        <div class="col-1">
                                          <i class="fas fa-plus-circle mr-2" (click)="addMoneyDebtAgent(i, j)" aria-hidden="true"></i>
                                          <i class="fas fa-ban" (click)="removeMoneyDebtAgent(i, j, k)" aria-hidden="true"></i>
                                        </div>
                                      </div>
                                  </div>
                              </div>
                            </div>
                        </div>
                        <div class="row">
                          <div class="form-group col">
                            <label>Debtor Name</label>
                            <input type="text" class="form-control" formControlName="debtorName" trim="blur">
                          </div>
                          <div class="form-group col">
                            <label>Debt Date</label>
                            <input type="text" class="form-control" formControlName="debtDate" trim="blur">
                          </div>
                        </div>
                      </div>
                    </div>
                    <div *ngIf="transactionObject['controls']['dependent']" class="card mb-3">
                      <div class="card-header">
                        <div class="row justify-content-end">
                          <div class="col-4">
                            <h5 class="text-center">Dependent</h5>
                          </div>
                          <div class="col-4">
                            <h5>
                              <i class="fa fa-times pull-right" (click)="removeAgentTransactionObject(i, j)" aria-hidden="true"></i>
                            </h5>
                          </div>
                        </div>
                      </div>
                      <div formGroupName="dependent" class="card-body">
                        <div class="row">
                          <div class="form-group col">
                            <label>Family Status</label>
                            <input type="text" class="form-control" formControlName="familyStatus" trim="blur">
                          </div>
                          <div class="form-group col">
                            <label>First Name</label>
                            <input type="text" class="form-control" formControlName="firstName" [typeahead]="firstNamesAllSorted" [typeaheadMinLength]="2" [typeaheadScrollable]="true" [typeaheadOptionsInScrollableView]="8" trim="blur">
                          </div>
                        </div>
                        <div class="row">
                          <div class="form-group col">
                            <label>Patronyme</label>
                            <input type="text" class="form-control" formControlName="patronyme" trim="blur">
                          </div>
                          <div class="form-group col">
                            <label>Last Name</label>
                            <input type="text" class="form-control" formControlName="lastName" trim="blur">
                          </div>
                        </div>
                        <div class="form-group">
                          <label>Relation to Agent</label>
                          <input type="text" class="form-control" formControlName="relationToAgent" trim="blur">
                        </div>
                      </div>
                    </div>
                    <div *ngIf="transactionObject['controls']['forfeit']" class="card mb-3">
                      <div class="card-header">
                        <div class="row justify-content-end">
                          <div class="col-4">
                            <h5 class="text-center">Forfeit</h5>
                          </div>
                          <div class="col-4">
                            <h5>
                              <i class="fa fa-times pull-right" (click)="removeAgentTransactionObject(i, j)" aria-hidden="true"></i>
                            </h5>
                          </div>
                        </div>
                      </div>
                      <div formArrayName="forfeit" class="card-body">
                        <label>Price in</label>
                        <div *ngFor="let forfeitAmount of transactionObject['controls']['forfeit']['controls']; let k=index">
                          <div [formGroupName]="k">
                                  <div class="form-group">
                                    <div class="row">
                                      <div class="col-2">
                                        <select class="form-control" formControlName="coins">
                                            <option value="unspecified">Unspecified</option>
                                            <option value="silver">Silver</option>
                                            <option value="copper">Copper</option>
                                            <option value="chekhi">Chekhi</option>
                                        </select>
                                      </div>
                                      <div class="col-2">
                                        <input type="number" min="0" class="form-control" formControlName="rubli" trim="blur">
                                      </div>
                                      <div class="col-1 small-label">rubli</div>
                                      <div class="col-2">
                                        <input type="number" min="0" class="form-control" formControlName="altyny" trim="blur">
                                      </div>
                                      <div class="col-1 small-label">altyny</div>
                                      <div class="col-2">
                                        <input type="number" min="0" class="form-control" formControlName="dengi" trim="blur">
                                      </div>
                                      <div class="col-1 small-label">den'gi</div>
                                      <div class="col-1">
                                        <i class="fas fa-plus-circle mr-2" (click)="addMoneyForfeitAgent(i, j)" aria-hidden="true"></i>
                                        <i class="fas fa-ban" (click)="removeMoneyForfeitAgent(i, j, k)" aria-hidden="true"></i>
                                      </div>
                                    </div>
                                </div>
                            </div>
                          </div>
                      </div>
                    </div>
                    <div *ngIf="transactionObject['controls']['fugitiveSouls']" class="card mb-3">
                      <div class="card-header">
                        <div class="row justify-content-end">
                          <div class="col-4">
                            <h5 class="text-center">Fugitive Souls</h5>
                          </div>
                          <div class="col-4">
                            <h5>
                              <i class="fa fa-times pull-right" (click)="removeAgentTransactionObject(i, j)" aria-hidden="true"></i>
                            </h5>
                          </div>
                        </div>
                      </div>
                      <div formGroupName="fugitiveSouls" class="card-body">
                        <div class="form-group">
                          <label>Juridical Status</label>
                          <input class="form-control" formControlName="juridicalStatus" trim>
                        </div>
                        <div class="form-group row" formGroupName="numberOfSouls">
                          <label class="col-2">Number of Souls: </label>
                          <div class="col-1">
                            <input type="number" min="0" class="form-control" formControlName="male" trim="blur">
                          </div>
                          <div class="col-1">male</div>
                          <div class="col-1">
                            <input type="number" min="0" class="form-control" formControlName="female" trim="blur">
                          </div>
                          <div class="col-1">female</div>
                          <div class="col-2">
                            <div class="form-check form-check-inline">
                              <label class="form-check-label">
                                <input class="form-check-input" type="radio" formControlName="operator" value="or"> OR
                              </label>
                            </div>
                            <div class="form-check form-check-inline">
                              <label class="form-check-label">
                                <input class="form-check-input" type="radio" formControlName="operator" value="and"> AND
                              </label>
                            </div>
                          </div>
                          <div class="col-2">
                            <input type="number" min="0" class="form-control" formControlName="households" trim="blur">
                          </div>
                          <div class="col-1">households</div>
                        </div>
                        <div class="form-group">
                          <label>Names</label>
                          <input type="text" class="form-control" formControlName="names">
                        </div>
                        <div class="form-group">
                          <label>Years of rent</label>
                          <input type="number" min="0" class="form-control" formControlName="yearsOfRent" trim="blur">
                        </div>
                      </div>
                    </div>
                    <div *ngIf="transactionObject['controls']['goods']" class="card mb-3">
                      <div class="card-header">
                        <div class="row justify-content-end">
                          <div class="col-4">
                            <h5 class="text-center">Goods</h5>
                          </div>
                          <div class="col-4">
                            <h5>
                              <i class="fa fa-times pull-right" (click)="removeAgentTransactionObject(i, j)" aria-hidden="true"></i>
                            </h5>
                          </div>
                        </div>
                      </div>
                      <div formGroupName="goods" class="card-body">
                        <div class="row">
                          <div class="form-group col-4">
                            <label>Type</label>
                            <input type="text" class="form-control" formControlName="type" trim="blur">
                          </div>
                          <div class="form-group col-8">
                            <label>Description</label>
                            <input type="text" class="form-control" formControlName="description" trim="blur">
                          </div>
                        </div>
                        <div formArrayName="price">
                          <label>Price in</label>
                          <div *ngFor="let priceGoods of transactionObject['controls']['goods']['controls']['price']['controls']; let k=index">
                            <div [formGroupName]="k">
                                    <div class="form-group">
                                      <div class="row">
                                        <div class="col-2">
                                          <select class="form-control" formControlName="coins">
                                              <option value="unspecified">Unspecified</option>
                                              <option value="silver">Silver</option>
                                              <option value="copper">Copper</option>
                                              <option value="chekhi">Chekhi</option>
                                          </select>
                                        </div>
                                        <div class="col-2">
                                          <input type="number" min="0" class="form-control" formControlName="rubli" trim="blur">
                                        </div>
                                        <div class="col-1 small-label">rubli</div>
                                        <div class="col-2">
                                          <input type="number" min="0" class="form-control" formControlName="altyny" trim="blur">
                                        </div>
                                        <div class="col-1 small-label">altyny</div>
                                        <div class="col-2">
                                          <input type="number" min="0" class="form-control" formControlName="dengi" trim="blur">
                                        </div>
                                        <div class="col-1 small-label">den'gi</div>
                                        <div class="col-1">
                                          <i class="fas fa-plus-circle mr-2" (click)="addMoneyGoodsAgent(i, j)" aria-hidden="true"></i>
                                          <i class="fas fa-ban" (click)="removeMoneyGoodsAgent(i, j, k)" aria-hidden="true"></i>
                                        </div>
                                      </div>
                                  </div>
                              </div>
                            </div>
                        </div>
                      </div>
                    </div>
                    <div *ngIf="transactionObject['controls']['immovableProperty']" class="card mb-3">
                      <div class="card-header">
                        <div class="row justify-content-end">
                          <div class="col-4">
                            <h5 class="text-center">Immovable Property</h5>
                          </div>
                          <div class="col-4">
                            <h5>
                              <i class="fa fa-times pull-right" (click)="removeAgentTransactionObject(i, j)" aria-hidden="true"></i>
                            </h5>
                          </div>
                        </div>
                      </div>
                      <div formGroupName="immovableProperty" class="card-body">
                        <div class="row">
                          <div class="form-group col">
                            <label>Type</label>
                            <select class="form-control" formControlName="type" (change)="updateAgentImmovablePropertyType(i,j)">
                              <option *ngFor="let immovablePropertyValue of immovablePropertyList" [value]="immovablePropertyValue">{{ immovablePropertyValue }}</option>
                            </select>
                          </div>
                          <div class="form-group col">
                            <label>Share</label>
                            <select class="form-control" formControlName="share" (change)="updateAgentImmovablePropertyShare(i,j)">
                              <option *ngFor="let shareValue of shareList" [value]="shareValue">{{ shareValue }}</option>
                            </select>
                          </div>
                        </div>
                        <div *ngIf="updateAgentImmovablePropertyType(i,j)" class="form-group">
                          <label>Other type</label>
                          <input type="text" class="form-control" formControlName="otherImmovablePropertyType" trim="blur">
                        </div>

                        <div *ngIf="updateAgentImmovablePropertyShare(i,j)" class="form-group">
                          <label>Other share</label>
                          <input type="text" class="form-control" formControlName="otherImmovablePropertyShare" trim="blur">
                        </div>
                        <div class="row">
                          <div class="form-group col-3">
                            <label>Origin</label>
                            <input type="text" class="form-control" formControlName="origin" trim="blur">
                          </div>
                          <div class="form-group col-3">
                            <label>Localisation</label>
                            <input type="text" class="form-control" formControlName="localisation" [typeahead]="geogrStatusesSorted" [typeaheadMinLength]="2" [typeaheadScrollable]="true" [typeaheadOptionsInScrollableView]="8" trim="blur">
                          </div>
                          <div class="form-group col-6">
                            <label>Neighbours</label>
                            <input type="text" class="form-control" formControlName="neighbours" trim="blur">
                          </div>
                        </div>
                        <div class="form-group" formGroupName="surface">
                          <label>Surface</label>
                          <div class="row">
                            <div class="col-3">
                              <input type="number" min="0" class="form-control" formControlName="chetiVpole" trim="blur">
                            </div>
                            <div class="col-2">cheti v pole</div>
                            <div class="col-1 text-center">OR</div>
                            <div formGroupName="sazheni" class="col-6">
                              <div class="row">
                                <div class="col-3">
                                  <input type="number" min="0" class="form-control" formControlName="x" trim="blur">
                                </div>
                                <div class="col-1 text-center">x</div>
                                <div class="col-3">
                                  <input type="number" min="0" class="form-control" formControlName="y" trim="blur">
                                </div>
                                <div class="col-1">sazheni</div>
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="form-group" formGroupName="population">
                          <label>Population (souls)</label>
                          <div class="row">
                            <div class="col-2">
                              <input type="number" min="0" class="form-control" formControlName="male" trim="blur">
                            </div>
                            <div class="col-1">male</div>
                            <div class="col-2">
                              <input type="number" min="0" class="form-control" formControlName="female" trim="blur">
                            </div>
                            <div class="col-1">female</div>
                            <div class="col-2">
                              <div class="form-check form-check-inline">
                                <label class="form-check-label">
                                  <input class="form-check-input" type="radio" formControlName="operator" value="or"> OR
                                </label>
                              </div>
                              <div class="form-check form-check-inline">
                                <label class="form-check-label">
                                  <input class="form-check-input" type="radio" formControlName="operator" value="and"> AND
                                </label>
                              </div>
                            </div>
                            <div class="col-2">
                              <input type="number" min="0" class="form-control" formControlName="households" trim="blur">
                            </div>
                            <div class="col-1">households</div>
                          </div>
                        </div>
                        <div class="row">
                          <div class="form-group col">
                            <label>Buildings</label>
                            <input type="text" class="form-control" formControlName="buildings" trim="blur">
                          </div>
                          <div class="form-group col">
                            <label>Appurtenances</label>
                            <input type="text" class="form-control" formControlName="appurtenances" trim="blur">
                          </div>
                        </div>
                      </div>
                    </div>
                    <div *ngIf="transactionObject['controls']['money']" class="card mb-3">
                      <div class="card-header">
                        <div class="row justify-content-end">
                          <div class="col-4">
                            <h5 class="text-center">Money</h5>
                          </div>
                          <div class="col-4">
                            <h5>
                              <i class="fa fa-times pull-right" (click)="removeAgentTransactionObject(i, j)" aria-hidden="true"></i>
                            </h5>
                          </div>
                        </div>
                      </div>
                      <div formArrayName="money"class=" card-body">
                        <label>Amount in</label>
                        <div *ngFor="let moneyAmount of transactionObject['controls']['money']['controls']; let k=index">
                          <div [formGroupName]="k">
                                  <div class="form-group">
                                    <div class="row">
                                      <div class="col-2">
                                        <select class="form-control" formControlName="coins">
                                            <option value="unspecified">Unspecified</option>
                                            <option value="silver">Silver</option>
                                            <option value="copper">Copper</option>
                                            <option value="chekhi">Chekhi</option>
                                        </select>
                                      </div>
                                      <div class="col-2">
                                        <input type="number" min="0" class="form-control" formControlName="rubli" trim="blur">
                                      </div>
                                      <div class="col-1 small-label">rubli</div>
                                      <div class="col-2">
                                        <input type="number" min="0" class="form-control" formControlName="altyny" trim="blur">
                                      </div>
                                      <div class="col-1 small-label">altyny</div>
                                      <div class="col-2">
                                        <input type="number" min="0" class="form-control" formControlName="dengi" trim="blur">
                                      </div>
                                      <div class="col-1 small-label">den'gi</div>
                                      <div class="col-1">
                                        <i class="fas fa-plus-circle mr-2" (click)="addMoneyMoneyAgent(i, j)" aria-hidden="true"></i>
                                        <i class="fas fa-ban" (click)="removeMoneyMoneyAgent(i, j, k)" aria-hidden="true"></i>
                                      </div>
                                    </div>
                                </div>
                            </div>
                          </div>
                      </div>
                    </div>
                    <div *ngIf="transactionObject['controls']['parent']" class="card mb-3">
                      <div class="card-header">
                        <div class="row justify-content-end">
                          <div class="col-4">
                            <h5 class="text-center">Parent</h5>
                          </div>
                          <div class="col-4">
                            <h5>
                              <i class="fa fa-times pull-right" (click)="removeAgentTransactionObject(i, j)" aria-hidden="true"></i>
                            </h5>
                          </div>
                        </div>
                      </div>
                      <div formGroupName="parent" class="card-body">
                        <div class="form-group">
                          <label>Co-Agent</label>
                          <select class="form-control" formControlName="coAgentNumber">
                            <option *ngFor="let value of deedForm['controls'].coAgents['controls']; let i=index" [value]="'coAgent' + (i+1)">Co-Agent {{ i + 1 }}</option>
                          </select>
                        </div>
                      </div>
                    </div>
                    <div *ngIf="transactionObject['controls']['responsabilies']" class="card mb-3">
                      <div class="card-header">
                        <div class="row justify-content-end">
                          <div class="col-4">
                            <h5 class="text-center">Responsabilities</h5>
                          </div>
                          <div class="col-4">
                            <h5>
                              <i class="fa fa-times pull-right" (click)="removeAgentTransactionObject(i, j)" aria-hidden="true"></i>
                            </h5>
                          </div>
                        </div>
                      </div>
                      <div formGroupName="responsabilities" class="card-body">
                        <div class="form-group">
                          <label>Description</label>
                          <input type="text" class="form-control" formControlName="description">
                        </div>
                      </div>
                    </div>
                    <div *ngIf="transactionObject['controls']['shareFromEstate']" class="card mb-3">
                      <div class="card-header">
                        <div class="row justify-content-end">
                          <div class="col-4">
                            <h5 class="text-center">Share From Estate</h5>
                          </div>
                          <div class="col-4">
                            <h5>
                              <i class="fa fa-times pull-right" (click)="removeAgentTransactionObject(i, j)" aria-hidden="true"></i>
                            </h5>
                          </div>
                        </div>
                      </div>
                      <div formGroupName="shareFromEstate" class="card-body">
                        <div class="form-group">
                          <label>Share</label>
                          <select class="form-control" formControlName="share" (change)="updateAgentShareFromEstate(i,j)">
                            <option *ngFor="let shareValue of shareList" [value]="shareValue">{{ shareValue }}</option>
                          </select>
                        </div>
                        <div *ngIf="updateAgentShareFromEstate(i,j)" class="form-group">
                          <label>Other Share</label>
                          <input type="text" class="form-control" formControlName="otherShareFromEstate" trim="blur">
                        </div>
                        <div class="form-group">
                          <label>Description</label>
                          <input type="text" class="form-control" formControlName="description" trim="blur">
                        </div>
                      </div>
                    </div>
                    <div *ngIf="transactionObject['controls']['souls']" class="card mb-3">
                      <div class="card-header">
                        <div class="row justify-content-end">
                          <div class="col-4">
                            <h5 class="text-center">Souls</h5>
                          </div>
                          <div class="col-4">
                            <h5>
                              <i class="fa fa-times pull-right" (click)="removeAgentTransactionObject(i, j)" aria-hidden="true"></i>
                            </h5>
                          </div>
                        </div>
                      </div>
                      <div formGroupName="souls" class="card-body">
                        <div class="form-group">
                          <label>Juridical Status</label>
                          <input class="form-control" formControlName="juridicalStatus" trim="blur">
                        </div>
                        <div class="form-group" formGroupName="numberOfSouls" trim="blur">
                          <label>Number of Souls</label>
                          <div class="row">
                            <div class="col-2">
                              <input type="number" min="0" class="form-control" formControlName="male" trim="blur">
                            </div>
                            <div class="col-1">male</div>
                            <div class="col-2">
                              <input type="number" min="0" class="form-control" formControlName="female" trim="blur">
                            </div>
                            <div class="col-1">female</div>
                            <div class="col-2">
                              <div class="form-check form-check-inline">
                                <label class="form-check-label">
                                  <input class="form-check-input" type="radio" formControlName="operator" value="or"> OR
                                </label>
                              </div>
                              <div class="form-check form-check-inline">
                                <label class="form-check-label">
                                  <input class="form-check-input" type="radio" formControlName="operator" value="and"> AND
                                </label>
                              </div>
                            </div>
                            <div class="col-2">
                              <input type="number" min="0" class="form-control" formControlName="households" trim="blur">
                            </div>
                            <div class="col-1">households</div>
                          </div>
                        </div>
                        <div class="form-group">
                          <label>Names</label>
                          <input type="text" class="form-control" formControlName="names" trim="blur">
                        </div>
                      </div>
                    </div>
                    <div *ngIf="transactionObject['controls']['other']" class="card mb-3">
                      <div class="card-header">
                        <div class="row justify-content-end">
                          <div class="col-4">
                            <h5 class="text-center">Other</h5>
                          </div>
                          <div class="col-4">
                            <h5>
                              <i class="fa fa-times pull-right" (click)="removeAgentTransactionObject(i, j)" aria-hidden="true"></i>
                            </h5>
                          </div>
                        </div>
                      </div>
                      <div class="form-group" class="card-body">
                        <label>Other</label>
                        <input type="text" class="form-control" formControlName="other" trim="blur">
                      </div>
                    </div>
                    <div *ngIf="transactionObject['controls']['asWhom']">
                      <div [ngSwitch]="selectedAsWhomValue">
                        <div *ngSwitchCase="'as hired worker'">
                          <div class="form-group">
                            <label>To Do What</label>
                            <input type="text" class="form-control" formControlName="toDoWhat" trim="blur">
                          </div>
                        </div>
                        <div *ngSwitchCase="'in household'">
                          <div class="form-group">
                            <label>With Family</label>
                            <div class="form-check form-check-inline">
                              <label class="form-check-label">
                                <input class="form-check-input" type="radio" formControlName="withFamily" value="yes"> Yes
                              </label>
                            </div>
                            <div class="form-check form-check-inline">
                              <label class="form-check-label">
                                <input class="form-check-input" type="radio" formControlName="withFamily" value="no"> No
                              </label>
                            </div>
                          </div>
                        </div>
                        <div *ngSwitchCase="'as contractor'">
                          <div class="form-group">
                            <label>Activity</label>
                            <select class="form-control" formControlName="activity">
                              <option *ngFor="let activityValue of activityList" [value]="activityValue">{{ activityValue }}</option>
                            </select>
                          </div>
                        </div>
                        <div *ngSwitchCase="'as tax-farmer'">
                          <div class="form-group">
                            <label>Type/Object of tax</label>
                            <select class="form-control" formControlName="type">
                              <option *ngFor="let typeTaxValue of typeTaxList" [value]="typeTaxValue">{{ typeTaxValue }}</option>
                            </select>
                          </div>
                          <div class="form-group">
                            <label>Description</label>
                            <input type="text" class="form-control" formControlName="description" trim="blur">
                          </div>
                          <div class="form-group" formGroupName="annualRent">
                            <label>Annual Rent</label>
                            <div class="row">
                              <div class="col-2">
                                <input type="number" min="0" class="form-control" formControlName="rubli" trim="blur">
                              </div>
                              <div class="col-1">rubli</div>
                              <div class="col-2">
                                <input type="number" min="0" class="form-control" formControlName="altyny" trim="blur">
                              </div>
                              <div class="col-1">altyny</div>
                              <div class="col-2">
                                <input type="number" min="0" class="form-control" formControlName="dengi" trim="blur">
                              </div>
                              <div class="col-1">den'gi</div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div *ngIf="selectedAction === 'bequeaths'" class="form-group">
                      <label>Who inherits</label>
                      <select class="form-control" formControlName="whoInherits">
                        <option value="counterAgent">Counter Agent</option>
                        <option *ngFor="let value of deedForm['controls'].coCounterAgents['controls']; let i=index" [value]="'coCounterAgent' + (i+1)">Co-Counter Agent {{ i + 1 }}</option>
                      </select>
                    </div>
                  </div>
                </div>
              </div>

              <!-- COUNTER AGENT TRANSACTION -->
              <div [ngSwitch]="counterAgentField">
                <div *ngSwitchCase="'text'">
                  <div class="form-group">
                    <label>What the Counter Agent does ?</label>
                    <input type="text" class="form-control" formControlName="counterAgentAction">
                  </div>
                </div>
                <div *ngSwitchCase="'selectMarry'">
                  <div class="form-group">
                    <label>What the Counter Agent does ?</label>
                    <select class="form-control" formControlName="counterAgentAction" (change)="updateCounterAgentAction(i)">
                      <option value="agrees to marry">agrees to marry</option>
                      <option value="agrees to marry-off">agrees to marry-off</option>
                    </select>
                  </div>
                </div>
                <div *ngSwitchCase="'select'">
                  <div class="form-group">
                    <label>What the Counter Agent does ?</label>
                    <select class="form-control" formControlName="counterAgentAction" (change)="updateCounterAgentAction(i)">
                      <option *ngFor="let action of counterAgentActionsList" [value]="action">{{ action }}</option>
                    </select>
                  </div>
                </div>
                <div [ngSwitch]="selectedCounterAction">
                  <div *ngSwitchCase="'what'">
                    <div class="form-group">
                      <label>What ?</label>
                      <select class="form-control" formControlName="counterAgentTransactionObjectType" (change)="selectedCounterWhat(i)">
                        <option *ngFor="let what of whatList" [value]="what">{{ what }}</option>
                      </select>
                    </div>
                  </div>
                  <div *ngSwitchCase="'whom'">
                    <div class="form-group">
                      <label>Whom ?</label>
                      <select class="form-control" #counterWhom (change)="selectedCounterWhom(counterWhom.value, i)">
                        <option *ngFor="let whom of whomList" [value]="whom">{{ whom }}</option>
                      </select>
                    </div>
                  </div>
                  <div *ngSwitchCase="'settles'">
                    <div class="form-group">
                      <label>Accusation against Counter Agent</label>
                      <input type="text" class="form-control" formControlName="accusationAgainstCounterAgent" trim="blur">
                    </div>
                    <div class="form-group">
                      <label>Juridical Procedure Stage</label>
                      <input type="text" class="form-control" formControlName="juridicalProcedureStage" trim="blur">
                    </div>
                  </div>
                </div>
              </div>

              <div formArrayName='counterAgentTransactionObjects'>
                <div *ngFor="let transactionCounterObject of transaction['controls']['counterAgentTransactionObjects']['controls']; let j=index">
                  <div [formGroupName]="j">
                    <div *ngIf="transactionCounterObject['controls']['chattels']" class="card mb-3">
                      <div class="card-header">
                        <div class="row justify-content-end">
                          <div class="col-4">
                            <h5 class="text-center">Chattels</h5>
                          </div>
                          <div class="col-4">
                            <h5>
                              <i class="fa fa-times pull-right" (click)="removeCounterAgentTransactionObject(i, j)" aria-hidden="true"></i>
                            </h5>
                          </div>
                        </div>
                      </div>
                      <div formGroupName="chattels" class="card-body">
                        <div class="row">
                          <div class="form-group col">
                            <label>Type</label>
                            <input type="text" class="form-control" formControlName="type" trim="blur">
                          </div>
                          <div class="form-group col">
                            <label>Origin</label>
                            <input type="text" class="form-control" formControlName="origin" trim="blur">
                          </div>
                        </div>
                        <div class="row">
                          <div class="form-group col-12">
                            <label>Description</label>
                            <input type="text" class="form-control" formControlName="description" trim="blur">
                          </div>
                        </div>
                        <div class="row">
                          <div class="form-group col-12">
                            <div formArrayName="price">
                              <label>Price in</label>
                              <div *ngFor="let priceChattel of transactionCounterObject['controls']['chattels']['controls']['price']['controls']; let k=index">
                                <div [formGroupName]="k">
                                        <div class="form-group">
                                          <div class="row">
                                            <div class="col-2">
                                              <select class="form-control" formControlName="coins">
                                                  <option value="unspecified">Unspecified</option>
                                                  <option value="silver">Silver</option>
                                                  <option value="copper">Copper</option>
                                                  <option value="chekhi">Chekhi</option>
                                              </select>
                                            </div>
                                            <div class="col-2">
                                              <input type="number" min="0" class="form-control" formControlName="rubli" trim="blur">
                                            </div>
                                            <div class="col-1 small-label">rubli</div>
                                            <div class="col-2">
                                              <input type="number" min="0" class="form-control" formControlName="altyny" trim="blur">
                                            </div>
                                            <div class="col-1 small-label">altyny</div>
                                            <div class="col-2">
                                              <input type="number" min="0" class="form-control" formControlName="dengi" trim="blur">
                                            </div>
                                            <div class="col-1 small-label">den'gi</div>
                                            <div class="col-1">
                                              <i class="fas fa-plus-circle mr-2" (click)="addMoneyChattelsCounterAgent(i, j)" aria-hidden="true"></i>
                                              <i class="fas fa-ban" (click)="removeMoneyChattelsCounterAgent(i, j, k)" aria-hidden="true"></i>
                                            </div>
                                          </div>
                                      </div>
                                  </div>
                                </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div *ngIf="transactionCounterObject['controls']['debt']" class="card mb-3">
                      <div class="card-header">
                        <div class="row justify-content-end">
                          <div class="col-4">
                            <h5 class="text-center">Debt</h5>
                          </div>
                          <div class="col-4">
                            <h5>
                              <i class="fa fa-times pull-right" (click)="removeCounterAgentTransactionObject(i, j)" aria-hidden="true"></i>
                            </h5>
                          </div>
                        </div>
                      </div>
                      <div formGroupName="debt" class="card-body">
                        <div formArrayName="amount">
                          <label>Amount in</label>
                          <div *ngFor="let amountDebt of transactionCounterObject['controls']['debt']['controls']['amount']['controls']; let k=index">
                            <div [formGroupName]="k">
                                    <div class="form-group">
                                      <div class="row">
                                        <div class="col-2">
                                          <select class="form-control" formControlName="coins">
                                              <option value="unspecified">Unspecified</option>
                                              <option value="silver">Silver</option>
                                              <option value="copper">Copper</option>
                                              <option value="chekhi">Chekhi</option>
                                          </select>
                                        </div>
                                        <div class="col-2">
                                          <input type="number" min="0" class="form-control" formControlName="rubli" trim="blur">
                                        </div>
                                        <div class="col-1 small-label">rubli</div>
                                        <div class="col-2">
                                          <input type="number" min="0" class="form-control" formControlName="altyny" trim="blur">
                                        </div>
                                        <div class="col-1 small-label">altyny</div>
                                        <div class="col-2">
                                          <input type="number" min="0" class="form-control" formControlName="dengi" trim="blur">
                                        </div>
                                        <div class="col-1 small-label">den'gi</div>
                                        <div class="col-1">
                                          <i class="fas fa-plus-circle mr-2" (click)="addMoneyDebtCounterAgent(i, j)" aria-hidden="true"></i>
                                          <i class="fas fa-ban" (click)="removeMoneyDebtCounterAgent(i, j, k)" aria-hidden="true"></i>
                                        </div>
                                      </div>
                                  </div>
                              </div>
                            </div>
                        </div>
                        <div class="row">
                          <div class="form-group col">
                            <label>Debtor Name</label>
                            <input type="text" class="form-control" formControlName="debtorName" trim="blur">
                          </div>
                          <div class="form-group col">
                            <label>Debtor Date</label>
                            <input type="text" class="form-control" formControlName="debtDate" trim="blur">
                          </div>
                        </div>
                      </div>
                    </div>
                    <div *ngIf="transactionCounterObject['controls']['dependent']" class="card mb-3">
                      <div class="card-header">
                        <div class="row justify-content-end">
                          <div class="col-4">
                            <h5 class="text-center">Dependent</h5>
                          </div>
                          <div class="col-4">
                            <h5>
                              <i class="fa fa-times pull-right" (click)="removeCounterAgentTransactionObject(i, j)" aria-hidden="true"></i>
                            </h5>
                          </div>
                        </div>
                      </div>
                      <div formGroupName="dependent" class="card-body">
                        <div class="row">
                          <div class="form-group col">
                            <label>Family Status</label>
                            <input type="text" class="form-control" formControlName="familyStatus" trim="blur">
                          </div>
                          <div class="form-group col">
                            <label>First Name</label>
                            <input type="text" class="form-control" formControlName="firstName" trim="blur" [typeahead]="firstNamesAllSorted"  [typeaheadMinLength]="0" [typeaheadScrollable]="true" [typeaheadOptionsInScrollableView]="8">
                          </div>
                        </div>
                        <div class="row">
                          <div class="form-group col">
                            <label>Patronyme</label>
                            <input type="text" class="form-control" formControlName="patronyme" trim="blur">
                          </div>
                          <div class="form-group col">
                            <label>Last Name</label>
                            <input type="text" class="form-control" formControlName="lastName" trim="blur">
                          </div>
                        </div>
                        <div class="form-group">
                          <label>Relation to Agent</label>
                          <input type="text" class="form-control" formControlName="relationToAgent" trim="blur">
                        </div>
                      </div>
                    </div>
                    <div *ngIf="transactionCounterObject['controls']['forfeit']" class="card mb-3">
                      <div class="card-header">
                        <div class="row justify-content-end">
                          <div class="col-4">
                            <h5 class="text-center">Forfeit</h5>
                          </div>
                          <div class="col-4">
                            <h5>
                              <i class="fa fa-times pull-right" (click)="removeCounterAgentTransactionObject(i, j)" aria-hidden="true"></i>
                            </h5>
                          </div>
                        </div>
                      </div>
                      <div formArrayName="forfeit" class="card-body">
                        <label>Price in</label>
                        <div *ngFor="let forfeitAmount of transactionCounterObject['controls']['forfeit']['controls']; let k=index">
                          <div [formGroupName]="k">
                                  <div class="form-group">
                                    <div class="row">
                                      <div class="col-2">
                                        <select class="form-control" formControlName="coins">
                                            <option value="unspecified">Unspecified</option>
                                            <option value="silver">Silver</option>
                                            <option value="copper">Copper</option>
                                            <option value="chekhi">Chekhi</option>
                                        </select>
                                      </div>
                                      <div class="col-2">
                                        <input type="number" min="0" class="form-control" formControlName="rubli" trim="blur">
                                      </div>
                                      <div class="col-1 small-label">rubli</div>
                                      <div class="col-2">
                                        <input type="number" min="0" class="form-control" formControlName="altyny" trim="blur">
                                      </div>
                                      <div class="col-1 small-label">altyny</div>
                                      <div class="col-2">
                                        <input type="number" min="0" class="form-control" formControlName="dengi" trim="blur">
                                      </div>
                                      <div class="col-1 small-label">den'gi</div>
                                      <div class="col-1">
                                        <i class="fas fa-plus-circle mr-2" (click)="addMoneyForfeitCounterAgent(i, j)" aria-hidden="true"></i>
                                        <i class="fas fa-ban" (click)="removeMoneyForfeitCounterAgent(i, j, k)" aria-hidden="true"></i>
                                      </div>
                                    </div>
                                </div>
                            </div>
                          </div>
                      </div>
                    </div>
                    <div *ngIf="transactionCounterObject['controls']['fugitiveSouls']" class="card mb-3">
                      <div class="card-header">
                        <div class="row justify-content-end">
                          <div class="col-4">
                            <h5 class="text-center">Fugitive Souls</h5>
                          </div>
                          <div class="col-4">
                            <h5>
                              <i class="fa fa-times pull-right" (click)="removeCounterAgentTransactionObject(i, j)" aria-hidden="true"></i>
                            </h5>
                          </div>
                        </div>
                      </div>
                      <div formGroupName="fugitiveSouls" class="card-body">
                        <div class="form-group">
                          <label>Juridical Status</label>
                          <input class="form-control" formControlName="juridicalStatus">
                        </div>
                        <div class="form-group row" formGroupName="numberOfSouls">
                          <label class="col-2">Number of Souls: </label>
                          <div class="col-1">
                            <input type="number" min="0" class="form-control" formControlName="male" trim="blur">
                          </div>
                          <div class="col-1">male</div>
                          <div class="col-1">
                            <input type="number" min="0" class="form-control" formControlName="female" trim="blur">
                          </div>
                          <div class="col-1">female</div>
                          <div class="col-2">
                            <div class="form-check form-check-inline">
                              <label class="form-check-label">
                                <input class="form-check-input" type="radio" formControlName="operator" value="or"> OR
                              </label>
                            </div>
                            <div class="form-check form-check-inline">
                              <label class="form-check-label">
                                <input class="form-check-input" type="radio" formControlName="operator" value="and"> AND
                              </label>
                            </div>
                          </div>
                          <div class="col-2">
                            <input type="number" min="0" class="form-control" formControlName="households" trim="blur">
                          </div>
                          <div class="col-1">households</div>
                        </div>
                        <div class="form-group">
                          <label>Names</label>
                          <input type="text" class="form-control" formControlName="names" trim="blur">
                        </div>
                        <div class="form-group">
                          <label>Years of rent</label>
                          <input type="number" min="0" class="form-control" formControlName="yearsOfRent" trim="blur">
                        </div>
                      </div>
                    </div>
                    <div *ngIf="transactionCounterObject['controls']['goods']" class="card mb-3">
                      <div class="card-header">
                        <div class="row justify-content-end">
                          <div class="col-4">
                            <h5 class="text-center">Goods</h5>
                          </div>
                          <div class="col-4">
                            <h5>
                              <i class="fa fa-times pull-right" (click)="removeCounterAgentTransactionObject(i, j)" aria-hidden="true"></i>
                            </h5>
                          </div>
                        </div>
                      </div>
                      <div formGroupName="goods" class="card-body">
                        <div class="row">
                          <div class="form-group col-4">
                            <label>Type</label>
                            <input type="text" class="form-control" formControlName="type" trim="blur">
                          </div>
                          <div class="form-group col-8">
                            <label>Description</label>
                            <input type="text" class="form-control" formControlName="description" trim="blur">
                          </div>
                        </div>
                        <div formArrayName="price">
                          <label>Price in</label>
                          <div *ngFor="let priceGoods of transactionCounterObject['controls']['goods']['controls']['price']['controls']; let k=index">
                            <div [formGroupName]="k">
                                    <div class="form-group">
                                      <div class="row">
                                        <div class="col-2">
                                          <select class="form-control" formControlName="coins">
                                              <option value="unspecified">Unspecified</option>
                                              <option value="silver">Silver</option>
                                              <option value="copper">Copper</option>
                                              <option value="chekhi">Chekhi</option>
                                          </select>
                                        </div>
                                        <div class="col-2">
                                          <input type="number" min="0" class="form-control" formControlName="rubli" trim="blur">
                                        </div>
                                        <div class="col-1 small-label">rubli</div>
                                        <div class="col-2">
                                          <input type="number" min="0" class="form-control" formControlName="altyny" trim="blur">
                                        </div>
                                        <div class="col-1 small-label">altyny</div>
                                        <div class="col-2">
                                          <input type="number" min="0" class="form-control" formControlName="dengi" trim="blur">
                                        </div>
                                        <div class="col-1 small-label">den'gi</div>
                                        <div class="col-1">
                                          <i class="fas fa-plus-circle mr-2" (click)="addMoneyGoodsCounterAgent(i, j)" aria-hidden="true"></i>
                                          <i class="fas fa-ban" (click)="removeMoneyGoodsCounterAgent(i, j, k)" aria-hidden="true"></i>
                                        </div>
                                      </div>
                                  </div>
                              </div>
                            </div>
                        </div>
                      </div>
                    </div>
                    <div *ngIf="transactionCounterObject['controls']['immovableProperty']" class="card mb-3">
                      <div class="card-header">
                        <div class="row justify-content-end">
                          <div class="col-4">
                            <h5 class="text-center">Immovable Property</h5>
                          </div>
                          <div class="col-4">
                            <h5>
                              <i class="fa fa-times pull-right" (click)="removeCounterAgentTransactionObject(i, j)" aria-hidden="true"></i>
                            </h5>
                          </div>
                        </div>
                      </div>
                      <div formGroupName="immovableProperty" class="card-body">
                        <div class="row">
                          <div class="form-group col">
                            <label>Type</label>
                            <select class="form-control" formControlName="type" (change)="updateCounterAgentImmovablePropertyType(i,j)">
                              <option *ngFor="let immovablePropertyValue of immovablePropertyList" [value]="immovablePropertyValue">{{ immovablePropertyValue }}</option>
                            </select>
                          </div>
                          <div class="form-group col">
                            <label>Share</label>
                            <select class="form-control" formControlName="share" (change)="updateCounterAgentImmovablePropertyShare(i,j)">
                              <option *ngFor="let shareValue of shareList" [value]="shareValue">{{ shareValue }}</option>
                            </select>
                          </div>
                        </div>
                        <div *ngIf="updateCounterAgentImmovablePropertyType(i,j)" class="form-group">
                          <label>Other type</label>
                          <input type="text" class="form-control" formControlName="otherImmovablePropertyType" trim="blur">
                        </div>

                        <div *ngIf="updateCounterAgentImmovablePropertyShare(i,j)" class="form-group">
                          <label>Other share</label>
                          <input type="text" class="form-control" formControlName="otherImmovablePropertyShare" trim="blur">
                        </div>
                        <div class="row">
                          <div class="form-group col-3">
                            <label>Origin</label>
                            <input type="text" class="form-control" formControlName="origin" trim="blur">
                          </div>
                          <div class="form-group col-3">
                            <label>Localisation</label>
                            <input type="text" class="form-control" formControlName="localisation" [typeahead]="geogrStatusesSorted" [typeaheadMinLength]="2" [typeaheadScrollable]="true" [typeaheadOptionsInScrollableView]="8" trim="blur">
                          </div>
                          <div class="form-group col-6">
                            <label>Neighbours</label>
                            <input type="text" class="form-control" formControlName="neighbours" trim="blur">
                          </div>
                        </div>
                        <div class="form-group" formGroupName="surface">
                          <label>Surface</label>
                          <div class="row">
                            <div class="col-3">
                              <input type="number" min="0" class="form-control" formControlName="chetiVpole" trim="blur">
                            </div>
                            <div class="col-2">cheti v pole</div>
                            <div class="col-1 text-center">OR</div>
                            <div formGroupName="sazheni" class="col-6">
                              <div class="row">
                                <div class="col-3">
                                  <input type="number" min="0" class="form-control" formControlName="x" trim="blur">
                                </div>
                                <div class="col-1 text-center">x</div>
                                <div class="col-3">
                                  <input type="number" min="0" class="form-control" formControlName="y" trim="blur">
                                </div>
                                <div class="col-1">sazheni</div>
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="form-group" formGroupName="population">
                          <label>Population (souls)</label>
                          <div class="row">
                            <div class="col-2">
                              <input type="number" min="0" class="form-control" formControlName="male" trim="blur">
                            </div>
                            <div class="col-1">male</div>
                            <div class="col-2">
                              <input type="number" min="0" class="form-control" formControlName="female" trim="blur">
                            </div>
                            <div class="col-1">female</div>
                            <div class="col-2">
                              <div class="form-check form-check-inline">
                                <label class="form-check-label">
                                  <input class="form-check-input" type="radio" formControlName="operator" value="or"> OR
                                </label>
                              </div>
                              <div class="form-check form-check-inline">
                                <label class="form-check-label">
                                  <input class="form-check-input" type="radio" formControlName="operator" value="and"> AND
                                </label>
                              </div>
                            </div>
                            <div class="col-2">
                              <input type="number" min="0" class="form-control" formControlName="households" trim="blur">
                            </div>
                            <div class="col-1">households</div>
                          </div>
                        </div>
                        <div class="row">
                          <div class="form-group col">
                            <label>Buildings</label>
                            <input type="text" class="form-control" formControlName="buildings" trim="blur">
                          </div>
                          <div class="form-group col">
                            <label>Appurtenances</label>
                            <input type="text" class="form-control" formControlName="appurtenances" trim="blur">
                          </div>
                        </div>
                      </div>
                    </div>
                    <div *ngIf="transactionCounterObject['controls']['money']" class="card mb-3">
                      <div class="card-header">
                        <div class="row justify-content-end">
                          <div class="col-4">
                            <h5 class="text-center">Money</h5>
                          </div>
                          <div class="col-4">
                            <h5>
                              <i class="fa fa-times pull-right" (click)="removeCounterAgentTransactionObject(i, j)" aria-hidden="true"></i>
                            </h5>
                          </div>
                        </div>
                      </div>
                      <div formArrayName="money"class=" card-body">
                        <label>Amount in</label>
                        <div *ngFor="let forfeitAmount of transactionCounterObject['controls']['money']['controls']; let k=index">
                          <div [formGroupName]="k">
                                  <div class="form-group">
                                    <div class="row">
                                      <div class="col-2">
                                        <select class="form-control" formControlName="coins">
                                            <option value="unspecified">Unspecified</option>
                                            <option value="silver">Silver</option>
                                            <option value="copper">Copper</option>
                                            <option value="chekhi">Chekhi</option>
                                        </select>
                                      </div>
                                      <div class="col-2">
                                        <input type="number" min="0" class="form-control" formControlName="rubli" trim="blur">
                                      </div>
                                      <div class="col-1 small-label">rubli</div>
                                      <div class="col-2">
                                        <input type="number" min="0" class="form-control" formControlName="altyny" trim="blur">
                                      </div>
                                      <div class="col-1 small-label">altyny</div>
                                      <div class="col-2">
                                        <input type="number" min="0" class="form-control" formControlName="dengi" trim="blur">
                                      </div>
                                      <div class="col-1 small-label">den'gi</div>
                                      <div class="col-1">
                                        <i class="fas fa-plus-circle mr-2" (click)="addMoneyMoneyCounterAgent(i, j)" aria-hidden="true"></i>
                                        <i class="fas fa-ban" (click)="removeMoneyMoneyCounterAgent(i, j, k)" aria-hidden="true"></i>
                                      </div>
                                    </div>
                                </div>
                            </div>
                          </div>
                      </div>
                    </div>
                    <div *ngIf="transactionCounterObject['controls']['parent']" class="card mb-3">
                      <div class="card-header">
                        <div class="row justify-content-end">
                          <div class="col-4">
                            <h5 class="text-center">Parent</h5>
                          </div>
                          <div class="col-4">
                            <h5>
                              <i class="fa fa-times pull-right" (click)="removeCounterAgentTransactionObject(i, j)" aria-hidden="true"></i>
                            </h5>
                          </div>
                        </div>
                      </div>
                      <div formGroupName="parent" class="card-body">
                        <div class="form-group">
                          <label>Co-Counter Agent</label>
                          <select class="form-control" formControlName="coCounterAgentNumber">
                            <option *ngFor="let value of deedForm['controls'].coCounterAgents['controls']; let i=index" [value]="'coCounterAgent' + (i+1)">Co-Counter Agent {{ i + 1 }}</option>
                          </select>
                        </div>
                      </div>
                    </div>
                    <div *ngIf="transactionCounterObject['controls']['responsabilies']" class="card mb-3">
                      <div class="card-header">
                        <div class="row justify-content-end">
                          <div class="col-4">
                            <h5 class="text-center">Responsabilities</h5>
                          </div>
                          <div class="col-4">
                            <h5>
                              <i class="fa fa-times pull-right" (click)="removeCounterAgentTransactionObject(i, j)" aria-hidden="true"></i>
                            </h5>
                          </div>
                        </div>
                      </div>
                      <div formGroupName="responsabilities" class="card-body">
                        <div class="form-group">
                          <label>Description</label>
                          <input type="text" class="form-control" formControlName="description" trim="blur">
                        </div>
                      </div>
                    </div>
                    <div *ngIf="transactionCounterObject['controls']['shareFromEstate']" class="card mb-3">
                      <div class="card-header">
                        <div class="row justify-content-end">
                          <div class="col-4">
                            <h5 class="text-center">Share From Estate</h5>
                          </div>
                          <div class="col-4">
                            <h5>
                              <i class="fa fa-times pull-right" (click)="removeCounterAgentTransactionObject(i, j)" aria-hidden="true"></i>
                            </h5>
                          </div>
                        </div>
                      </div>
                      <div formGroupName="shareFromEstate" class="card-body">
                        <div class="form-group">
                          <label>Share</label>
                          <select class="form-control" formControlName="share">
                            <option *ngFor="let shareValue of shareList" [value]="shareValue">{{ shareValue }}</option>
                          </select>
                        </div>
                        <div *ngIf="updateCounterAgentShareFromEstate(i,j)" class="form-group">
                          <label>Other Share</label>
                          <input type="text" class="form-control" formControlName="otherShareFromEstate" trim="blur">
                        </div>
                        <div class="form-group">
                          <label>Description</label>
                          <input type="text" class="form-control" formControlName="description" trim="blur">
                        </div>
                      </div>
                    </div>
                    <div *ngIf="transactionCounterObject['controls']['souls']" class="card mb-3">
                      <div class="card-header">
                        <div class="row justify-content-end">
                          <div class="col-4">
                            <h5 class="text-center">Souls</h5>
                          </div>
                          <div class="col-4">
                            <h5>
                              <i class="fa fa-times pull-right" (click)="removeCounterAgentTransactionObject(i, j)" aria-hidden="true"></i>
                            </h5>
                          </div>
                        </div>
                      </div>
                      <div formGroupName="souls" class="card-body">
                        <div class="form-group">
                          <label>Juridical Status</label>
                          <input class="form-control" formControlName="juridicalStatus" trim="blur">
                        </div>
                        <div class="form-group" formGroupName="numberOfSouls" trim="blur">
                          <label>Number of Souls</label>
                          <div class="row">
                            <div class="col-2">
                              <input type="number" min="0" class="form-control" formControlName="male" trim="blur">
                            </div>
                            <div class="col-1">male</div>
                            <div class="col-2">
                              <input type="number" min="0" class="form-control" formControlName="female" trim="blur">
                            </div>
                            <div class="col-1">female</div>
                            <div class="col-2">
                              <div class="form-check form-check-inline">
                                <label class="form-check-label">
                                  <input class="form-check-input" type="radio" formControlName="operator" value="or"> OR
                                </label>
                              </div>
                              <div class="form-check form-check-inline">
                                <label class="form-check-label">
                                  <input class="form-check-input" type="radio" formControlName="operator" value="and"> AND
                                </label>
                              </div>
                            </div>
                            <div class="col-2">
                              <input type="number" min="0" class="form-control" formControlName="households" trim="blur">
                            </div>
                            <div class="col-1">households</div>
                          </div>
                        </div>
                        <div class="form-group">
                          <label>Names</label>
                          <input type="text" class="form-control" formControlName="names" trim="blur">
                        </div>
                      </div>
                    </div>
                    <div *ngIf="transactionCounterObject['controls']['other']" class="card mb-3">
                      <div class="card-header">
                        <div class="row justify-content-end">
                          <div class="col-4">
                            <h5 class="text-center">Other</h5>
                          </div>
                          <div class="col-4">
                            <h5>
                              <i class="fa fa-times pull-right" (click)="removeCounterAgentTransactionObject(i, j)" aria-hidden="true"></i>
                            </h5>
                          </div>
                        </div>
                      </div>
                      <div class="form-group" class="card-body">
                        <label>Other</label>
                        <input type="text" class="form-control" formControlName="other" trim="blur">
                      </div>
                    </div>
                    <div *ngIf="transactionCounterObject['controls']['asWhom']">
                      <div [ngSwitch]="selectedAsWhomValue">
                        <div *ngSwitchCase="'as hired worker'">
                          <div class="form-group">
                            <label>To Do What</label>
                            <input type="text" class="form-control" formControlName="toDoWhat" trim="blur">
                          </div>
                        </div>
                        <div *ngSwitchCase="'in household'">
                          <div class="form-group">
                            <label>With Family</label>
                            <div class="form-check form-check-inline">
                              <label class="form-check-label">
                                <input class="form-check-input" type="radio" formControlName="withFamily" value="yes"> Yes
                              </label>
                            </div>
                            <div class="form-check form-check-inline">
                              <label class="form-check-label">
                                <input class="form-check-input" type="radio" formControlName="withFamily" value="no"> No
                              </label>
                            </div>
                          </div>
                        </div>
                        <div *ngSwitchCase="'as contractor'">
                          <div class="form-group">
                            <label>Activity</label>
                            <select class="form-control" formControlName="activity">
                              <option *ngFor="let activityValue of activityList" [value]="activityValue">{{ activityValue }}</option>
                            </select>
                          </div>
                        </div>
                        <div *ngSwitchCase="'as tax-farmer'">
                          <div class="form-group">
                            <label>Type/Object of tax</label>
                            <select class="form-control" formControlName="type">
                              <option *ngFor="let typeTaxValue of typeTaxList" [value]="typeTaxValue">{{ typeTaxValue }}</option>
                            </select>
                          </div>
                          <div class="form-group">
                            <label>Description</label>
                            <input type="text" class="form-control" formControlName="description" trim="blur">
                          </div>
                          <div class="form-group" formGroupName="annualRent">
                            <label>Annual Rent</label>
                            <div class="row">
                              <div class="col-2">
                                <input type="number" min="0" class="form-control" formControlName="rubli" trim="blur">
                              </div>
                              <div class="col-1">rubli</div>
                              <div class="col-2">
                                <input type="number" min="0" class="form-control" formControlName="altyny" trim="blur">
                              </div>
                              <div class="col-1">altyny</div>
                              <div class="col-2">
                                <input type="number" min="0" class="form-control" formControlName="dengi" trim="blur">
                              </div>
                              <div class="col-1">den'gi</div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="card mt-5 mb-3">
                <div class="card-header">
                  <h5 class="text-center">Contract Information</h5>
                </div>
                <div class="card-body">
                  <div class="form-group row">
                    <label class="col-2">Advance Payment</label>
                    <div class="col-10">
                      <div class="form-check form-check-inline">
                        <label class="form-check-label">
                          <input class="form-check-input" type="radio" formControlName="advancePayment" value="yes"> Yes
                        </label>
                      </div>
                      <div class="form-check form-check-inline">
                        <label class="form-check-label">
                          <input class="form-check-input" type="radio" formControlName="advancePayment" value="no"> No
                        </label>
                      </div>
                    </div>
                  </div>
                  <div class="form-group">
                    <label>Contract Conditions</label>
                    <textarea class="form-control" formControlName="contractConditions" trim="blur"></textarea>
                  </div>
                  <div class="row">
                    <div class="form-group col">
                      <label>Contract Duration</label>
                      <input type="text" class="form-control" formControlName="contractDuration" trim="blur">
                    </div>
                    <div class="form-group col">
                      <label>Forfeit (roubles)</label>
                      <input type="text" class="form-control" formControlName="forfeit" trim="blur">
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- PANEL-BODY END -->
          </div>
          <!-- NGFOR END -->
        </div>
        <!-- FORMARRAYNAME TRANSACTIONS END  -->
      </div>
    </div>


    <!-- ACCESSORIES TO CONTRACT -->
    <div class="card shadow mb-3">
      <div class="card-body">
        <div class="text-center">
          <h3>
            <i class="fa fa-eye"></i> Accessories to contract</h3>
          <hr class="mt-2 mb-2">
        </div>

        <div *ngIf="deedForm['controls'].whitnesses['controls'].length === 0 && deedForm['controls'].sureties['controls'].length === 0 && !scribeOn && deedForm['controls'].otherParticipants['controls'].length === 0">
          <p class="lead text-center">
            No accessories to contract saved yet. Add a whitness, a surety, a scribe and/or another participant with the +ADD button.
          </p>
        </div>

        <div formArrayName="whitnesses">
          <div *ngFor="let coAgent of deedForm['controls'].whitnesses['controls']; let i=index" class="card mb-3">
            <div class="card-header blue-grey lighten-1">
              <div class="row justify-content-end">
                <div class="col-4">
                  <h5 class="text-center">Whitness {{i + 1}}</h5>
                </div>
                <div class="col-4">
                  <h5>
                    <i class="fa fa-times pull-right" (click)="removeWhitness(i)" aria-hidden="true"></i>
                  </h5>
                </div>
              </div>
            </div>
            <div class="card-body" [formGroupName]="i">
              <div formGroupName="whitness">
                <div class="row">
                  <div class="form-group col">
                    <label>Geogr Status</label>
                    <input type="text" class="form-control" formControlName="geogrStatus" [typeahead]="geogrStatusesSorted" [typeaheadMinLength]="2" [typeaheadScrollable]="true" [typeaheadOptionsInScrollableView]="8" autofocus trim="blur">
                  </div>
                  <div class="form-group col">
                    <label>Social Status</label>
                    <input type="text" class="form-control" formControlName="socialStatus" trim="blur">
                  </div>
                </div>
                <div class="row">
                  <div class="form-group col">
                    <label>First Name</label>
                    <input type="text" class="form-control" formControlName="firstName" trim="blur" [typeahead]="firstNamesAllSorted"  [typeaheadMinLength]="0" [typeaheadScrollable]="true" [typeaheadOptionsInScrollableView]="8">
                  </div>
                  <div class="form-group col">
                    <label>Patronyme</label>
                    <input type="text" class="form-control" formControlName="patronyme" trim="blur">
                  </div>
                </div>
                <div class="row">
                  <div class="form-group col">
                    <label>Last Name</label>
                    <input type="text" class="form-control" formControlName="lastName" trim="blur">
                  </div>
                  <div class="form-group col">
                    <label>Related To</label>
                    <input type="text" class="form-control" formControlName="relatedTo" trim="blur">
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div formArrayName="sureties">
          <div *ngFor="let coAgent of deedForm['controls'].sureties['controls']; let i=index" class="card mb-3">
            <div class="card-header blue-grey lighten-2">
              <div class="row justify-content-end">
                <div class="col-4">
                  <h5 class="text-center">Surety {{i + 1}}</h5>
                </div>
                <div class="col-4">
                  <h5>
                    <i class="fa fa-times pull-right" (click)="removeSurety(i)" aria-hidden="true"></i>
                  </h5>
                </div>
              </div>
            </div>
            <div class="card-body" [formGroupName]="i">
              <div formGroupName="surety">
                <div class="row">
                  <div class="form-group col">
                    <label>Geogr Status</label>
                    <input type="text" class="form-control" formControlName="geogrStatus" [typeahead]="geogrStatusesSorted" [typeaheadMinLength]="2" [typeaheadScrollable]="true" [typeaheadOptionsInScrollableView]="8" trim="blur">
                  </div>
                  <div class="form-group col">
                    <label>Social Status</label>
                    <input type="text" class="form-control" formControlName="socialStatus" trim="blur">
                  </div>
                </div>
                <div class="row">
                  <div class="form-group col">
                    <label>First Name</label>
                    <input type="text" class="form-control" formControlName="firstName" trim="blur" [typeahead]="firstNamesAllSorted"  [typeaheadMinLength]="0" [typeaheadScrollable]="true" [typeaheadOptionsInScrollableView]="8">
                  </div>
                  <div class="form-group col">
                    <label>Patronyme</label>
                    <input type="text" class="form-control" formControlName="patronyme" trim="blur">
                  </div>
                </div>
                <div class="row">
                  <div class="form-group col">
                    <label>Last Name</label>
                    <input type="text" class="form-control" formControlName="lastName" trim="blur">
                  </div>
                  <div class="form-group col">
                    <label>Related To</label>
                    <input type="text" class="form-control" formControlName="relatedTo" trim="blur">
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div *ngIf="scribeOn">
          <div formGroupName="scribe" class="card mb-3">
            <div class="card-header blue-grey lighten-3">
              <div class="row justify-content-end">
                <div class="col-4">
                  <h5 class="text-center">Scribe</h5>
                </div>
                <div class="col-4">
                  <h5>
                    <i class="fa fa-times pull-right" (click)="removeScribe()" aria-hidden="true"></i>
                  </h5>
                </div>
              </div>
            </div>
            <div class="card-body">
              <div class="row">
                <div class="form-group col">
                  <label>Geogr Status</label>
                  <input type="text" class="form-control" formControlName="geogrStatus" [typeahead]="geogrStatusesSorted" [typeaheadMinLength]="2" [typeaheadScrollable]="true" [typeaheadOptionsInScrollableView]="8" trim="blur">
                </div>
                <div class="form-group col">
                  <label>Social Status</label>
                  <input type="text" class="form-control" formControlName="socialStatus" trim="blur">
                </div>
              </div>
              <div class="row">
                <div class="form-group col">
                  <label>First Name</label>
                  <input type="text" class="form-control" formControlName="firstName" trim="blur" [typeahead]="firstNamesAllSorted"  [typeaheadMinLength]="0" [typeaheadScrollable]="true" [typeaheadOptionsInScrollableView]="8">
                </div>
                <div class="form-group col">
                  <label>Patronyme</label>
                  <input type="text" class="form-control" formControlName="patronyme" trim="blur">
                </div>
              </div>
              <div class="row">
                <div class="form-group col">
                  <label>Last Name</label>
                  <input type="text" class="form-control" formControlName="lastName" trim="blur">
                </div>
                <div class="form-group col">
                  <label>Related To</label>
                  <input type="text" class="form-control" formControlName="relatedTo" trim="blur">
                </div>
              </div>
            </div>
          </div>
        </div>

        <div formArrayName="otherParticipants">
          <div *ngFor="let coAgent of deedForm['controls'].otherParticipants['controls']; let i=index" class="card mb-3">
            <div class="card-header blue-grey lighten-4">
              <div class="row justify-content-end">
                <div class="col-4">
                  <h5 class="text-center">Other Participant {{i + 1}}</h5>
                </div>
                <div class="col-4">
                  <h5>
                    <i class="fa fa-times pull-right" (click)="removeOtherParticipant(i)" aria-hidden="true"></i>
                  </h5>
                </div>
              </div>
            </div>
            <div class="card-body" [formGroupName]="i">
              <div formGroupName="otherParticipant">
                <div class="form-group">
                  <label>Role</label>
                  <input type="text" class="form-control" formControlName="role" trim="blur">
                </div>
                <div class="row">
                  <div class="form-group col">
                    <label>Geogr Status</label>
                    <input type="text" class="form-control" formControlName="geogrStatus" [typeahead]="geogrStatusesSorted" [typeaheadMinLength]="2" [typeaheadScrollable]="true" [typeaheadOptionsInScrollableView]="8" trim="blur">
                  </div>
                  <div class="form-group col">
                    <label>Social Status</label>
                    <input type="text" class="form-control" formControlName="socialStatus" trim="blur">
                  </div>
                </div>
                <div class="row">
                  <div class="form-group col">
                    <label>First Name</label>
                    <input type="text" class="form-control" formControlName="firstName" trim="blur" [typeahead]="firstNamesAllSorted"  [typeaheadMinLength]="0" [typeaheadScrollable]="true" [typeaheadOptionsInScrollableView]="8">
                  </div>
                  <div class="form-group col">
                    <label>Patronyme</label>
                    <input type="text" class="form-control" formControlName="patronyme" trim="blur">
                  </div>
                </div>
                <div class="row">
                  <div class="form-group col">
                    <label>Last Name</label>
                    <input type="text" class="form-control" formControlName="lastName" trim="blur">
                  </div>
                  <div class="form-group col">
                    <label>Related To</label>
                    <input type="text" class="form-control" formControlName="relatedTo" trim="blur">
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

      </div>
    </div>



    <!-- REGISTRATION -->
    <div class="card shadow mb-3">
      <div class="card-body">
        <div class="text-center">
          <h3>
            <i class="fa fa-pencil-square-o"></i> Registration</h3>
          <hr class="mt-2 mb-2">
        </div>

        <div class="form-group">
          <label>Registration Date</label>
          <input type="text" class="form-control" formControlName="registrationDate" trim="blur">
        </div>
        <div *ngIf="!registratorOn">
          <p class="lead text-center">
            No registrator saved yet. Add one with the +ADD button.
          </p>
        </div>
        <div *ngIf="registratorOn">
          <div formGroupName="registrator" class="card mb-3">
            <div class="card-header">
              <div class="row justify-content-end">
                <div class="col-4">
                  <h5 class="text-center">Registrator</h5>
                </div>
                <div class="col-4">
                  <h5>
                    <i class="fa fa-times pull-right" (click)="removeRegistrator()" aria-hidden="true"></i>
                  </h5>
                </div>
              </div>
            </div>
            <div class="card-body">
              <div class="row mb-2">
                <div class="col">
                  <label>Choose a registrator in the list</label>
                  <select class="form-control" (change)="updateRegistrator($event.target.value)">
                    <option value=""></option>
                    <option *ngFor="let registrator of registratorList; let i=index" [value]="i">{{registrator.firstName}} {{registrator.patronyme}} {{registrator.lastName}}
                      <span *ngIf="registrator.relatedTo">, related to {{registrator.relatedTo}}</span>
                    </option>
                  </select>
                </div>
              </div>
              <div class="row mt-4 mb-2">
                <div class="col">
                  <label>Or create a new one</label>
                </div>
              </div>
              <div class="row">
                <div class="form-group col">
                  <label>First Name</label>
                  <input type="text" class="form-control" formControlName="firstName" trim="blur" [typeahead]="firstNamesAllSorted"  [typeaheadMinLength]="0" [typeaheadScrollable]="true" [typeaheadOptionsInScrollableView]="8">
                </div>
                <div class="form-group col">
                  <label>Patronyme</label>
                  <input type="text" class="form-control" formControlName="patronyme" trim="blur">
                </div>
              </div>
              <div class="row">
                <div class="form-group col">
                  <label>Last Name</label>
                  <input type="text" class="form-control" formControlName="lastName" trim="blur">
                </div>
                <div class="form-group col">
                  <label>Related To</label>
                  <input type="text" class="form-control" formControlName="relatedTo" trim="blur">
                </div>
              </div>
            </div>
          </div>
        </div>



        <div formGroupName="fees" class="card">
          <div class="card-header">
            <h5 class="text-center">Fees</h5>
          </div>
          <div class="card-body">
            <div formGroupName="tax">
              <div class="form-group">
                <label>Tax</label>
                <div class="row">
                  <div class="col-2 pr-0">
                    <input type="number" min="0" class="form-control" formControlName="roubles" trim="blur">
                  </div>
                  <div class="col-1">roubles</div>
                  <div class="col-2 pr-0">
                    <input type="number" min="0" class="form-control" formControlName="altyn" trim="blur">
                  </div>
                  <div class="col-1">altyn</div>
                  <div class="col-2 pr-0">
                    <input type="number" min="0" class="form-control" formControlName="denga" trim="blur">
                  </div>
                  <div class="col-1">denga</div>
                  <div class="col-1 pr-0">Collected: </div>
                  <div class="col-sm-2">
                    <div class="form-check form-check-inline">
                      <label class="form-check-label">
                        <input class="form-check-input" type="radio" formControlName="collected" value="yes"> Yes
                      </label>
                    </div>
                    <div class="form-check form-check-inline">
                      <label class="form-check-label">
                        <input class="form-check-input" type="radio" formControlName="collected" value="no"> No
                      </label>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div formGroupName="fee">
              <div class="form-group">
                <label>Fee</label>
                <div class="row">
                  <div class="col-2">
                    <input type="number" min="0" class="form-control" formControlName="roubles" trim="blur">
                  </div>
                  <div class="col-1">roubles</div>
                  <div class="col-2">
                    <input type="number" min="0" class="form-control" formControlName="altyn" trim="blur">
                  </div>
                  <div class="col-1">altyn</div>
                  <div class="col-2">
                    <input type="number" min="0" class="form-control" formControlName="denga" trim="blur">
                  </div>
                  <div class="col-1">denga</div>
                  <div class="col-1">Collected: </div>
                  <div class="col-sm-2">
                    <div class="form-check form-check-inline">
                      <label class="form-check-label">
                        <input class="form-check-input" type="radio" formControlName="collected" value="yes"> Yes
                      </label>
                    </div>
                    <div class="form-check form-check-inline">
                      <label class="form-check-label">
                        <input class="form-check-input" type="radio" formControlName="collected" value="no"> No
                      </label>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>


      </div>
    </div>



    <!-- ANNEXES -->

    <div class="card shadow mb-3">
      <div class="card-body">
        <div class="text-center">
          <h3>
            <i class="fa fa-question-circle"></i> Annexes</h3>
          <hr class="mt-2 mb-2">
        </div>

        <div class="form-group">
          <label>Verbatim Citations</label>
          <textarea rows="10" class="form-control" formControlName="verbatimCitations" trim="blur"></textarea>
        </div>
        <div class="form-group">
          <label>Researcher Notes</label>
          <textarea rows="10" class="form-control" formControlName="researcherNotes" trim="blur"></textarea>
        </div>
      </div>
    </div>

    <div class="card shadow mb-3">
      <div class="card-body">
        <div class="text-center">
          <h4>Is the form complete ?</h4>
          <div class="d-inline-flex justify-content-center align-items-center complete-toggle">
            <div class="slideLabel" (click)="setToggleNo()">NO</div>
            <mat-slide-toggle formControlName="complete">
              <span [ngClass]="classComplete()" style="font-weight: 700">YES</span>
            </mat-slide-toggle>
          </div>
        </div>
      </div>
    </div>

    <div class="card shadow mt-5 p-5">
      <h2 class="text-center">Current Json Document</h2>
      <pre>{{ deedForm.value | json }}</pre>
    </div>
  </div>

</form>
